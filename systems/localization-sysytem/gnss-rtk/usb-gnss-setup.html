<!DOCTYPE html>

<html lang="en">

        <head>
                <!-- Page information -->
                <meta charset="UTF-8" />
                <meta name="node_id" content="usb-gnss-setup">
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <link rel="shortcut icon" href="/gardenbot/favicon.ico" />

                <!-- Set title -->
                <title>gardenbot/notes</title>

                <!-- Includes -->
                <script src="/gardenbot/obs.html/static/obsidian_core.js"></script>
<script src="/gardenbot/obs.html/static/encoding.js"></script>
<link rel="stylesheet" href="/gardenbot/obs.html/static/master.css" />
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
            'securityLevel': 'loose',
            'theme': 'dark',
            'themeVariables': {
                    'darkMode': true,
            }
    });
</script>
<script>
  MathJax = {
    loader: {
      load: [
        '[tex]/action',
        'output/chtml',
        '[tex]/centernot'
      ]
    },
    tex: {
      inlineMath: [ ["\\(","\\)"] ],
      displayMath: [ ["\\[","\\]"] ],
      processEscapes: true,
      processEnvironments: true,
      packages: {'[+]': ['centernot']}
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<script src="/gardenbot/obs.html/static/flexsearch.bundle.js"></script>
<script src="/gardenbot/obs.html/static/pako.js"></script>
<script src="/gardenbot/obs.html/static/search.js"></script>
<script src="/gardenbot/obs.html/static/dirtree.js"></script>




                <!-- Onload tweaks -->
                <script>
                        const CURRENT_NODE = 'usb-gnss-setup';
                        const HTML_URL_PREFIX = '/gardenbot';
                        const PAGE_DEPTH = 3;
                </script>
        </head>

<body class="theme-obs-light">
        <div id="antiflash" style="display: none;"></div>
        <script>
                document.getElementById('antiflash').style.display = 'block';
        </script>
        <div id="search-master-div">
    <div id="search-slab" king_ramses="return the slaaab">
            <div id="search-controls">
                    <input id="search_string" placeholder="Type to search notes" type="text" />
                    <div class="tooltip" style="display: none;">
                        <input type="checkbox" id="hard_search" name="hard" />
                        <span class="tooltiptext">Hard search (require exact match)</span>
                    </div>
                    <div id="search-results-box">
                        <div id="search-results"></div>
                    </div>
                    <div id="search-instructions">
                        <div class="prompt-instruction mobile">
                            <button onclick="toggle_id('search-master-div');"><b>Close</b> Search </button>
                        </div>
                    </div>
            </div>
    </div>
</div>

<script>
    document.getElementById("search-master-div").addEventListener('click', e => {
            if(e.target !== e.currentTarget){
                    return
            }
            toggle_id('search-master-div');
    })
    document.getElementById("search_string").addEventListener("input", function(event) {
            setTimeout( () =>run_search('search_string', 'hard_search'), 100 );
    }); 
    document.getElementById("hard_search").addEventListener("click", function(event) {
            setTimeout( () =>run_search('search_string', 'hard_search'), 100 );
    });

    window.addEventListener('keydown', e => {
        if((e.key=='Escape'||e.key=='Esc'||e.keyCode==27)){
            toggle_id('search-master-div');
            return false;
        } 
    }, true);

    function click_list_link(element){
        element.parentElement.getElementsByTagName('a')[0].click()
    }
</script>

        <div id="page_holder" class="flex_col">
                <div id="header" class="header">
    <div id="header_flex" class="flex_row">
            <a href="/gardenbot/index.html" id="homelink" title="Clear screen and go to homepage">gardenbot/notes</a>
            <div id="menu_toggle_button" class="navbar-button requires_js" onclick="toggle_menu()">
                    ≡
            </div>
            <div id="navbar" class="navbar requires_js">
                    <a class="navbar-link" href="/gardenbot/index.html" title="Home">Home</a>
<a class="navbar-link" href="/gardenbot/systems/wire-system/wire-system.html" title="Wiring">Wiring</a>
<a class="navbar-link" href="/gardenbot/systems/localization-sysytem/gnss-rtk/usb-gnss-setup.html" title="GNSS RTK">GNSS RTK</a>
<a class="navbar-link" href="/gardenbot/systems/drive-system/drive-roboclaw-setup.html" title="Drive Motors">Drive Motors</a>
<a class="navbar-link" href="/gardenbot/systems/power-system/power-system.html" title="Power System">Power System</a>
<a class="navbar-link" href="/gardenbot/systems/computer-system/computer-rpi.html" title="Computer System">Computer System</a>
                    <div class="icon-tray">
                            <div id="theme-button" class="theme-button requires_js" title="Change theme" onclick="toggle_theme_popup(this)">
    T
</div>
<script>
    function toggle_theme_popup(el){
        // make theme button show that it's active by adding the .active class
        toggle(el);

        // show the theme selector
        toggle_id('theme-popup')

        let h2 = document.getElementById('header2')
        if (h2){
            let pu = document.getElementById('header2').getElementsByClassName('popup')[0];
            toggle(pu);
        }
    }

    function disable_theme_popup(){
        disable_id('theme-button');

        // show the theme selector
        disable_id('theme-popup')

        let h2 = document.getElementById('header2')
        if (h2){
            let pu = document.getElementById('header2').getElementsByClassName('popup')[0];
            disable(pu);
        }
    }
</script>
                                    <div onclick="openSearch()" class="theme-button requires_js">
            <img src = "/gardenbot/obs.html/static/search.svg" alt="Search notes" title="Search notes" style="margin: 4px;"/>
        </div>
        <script>
            function openSearch(){
                // toggle search popup and continue with extra code if it is enabled this time
                if (toggle_id('search-master-div')){
                    // get input field and temporarily disable it
                    let ss = document.getElementById('search_string');
                    ss.value = 'Seach data initializing...';
                    ss.readOnly = true; 

                    // load search data if not yet done so
                    setTimeout(function(){
                        LoadSearchData()

                        // clear input and put focus on it so that we can start typing immediately
                        ss.value = '';
                        ss.readOnly = false; 
                        ss.focus()
                        ss.select()
                    }, 100);
                }
            }
        </script>
                                    <div class="graph_header_div requires_js">
            <a id="graph_link" class="system-link" href="/gardenbot/obs.html/graph/index.html?node=usb-gnss-setup" title="Open fullpage Graph">
                    <img class="graph_header_div_svg" src = "/gardenbot/obs.html/static/graph.svg" alt="Open fullpage Graph" style="margin: 2px; width: 17px;"/>
            </a>
        </div>
                                    <div >
            <a id="dirtree_link" class="system-link" href="/gardenbot/dirtree.html" title="View directory tree">
                    <img src = "/gardenbot/obs.html/static/dirtree.svg" style="width: 12px; padding: 4px;" alt="Directory tree link"/>
            </a>
        </div>
                            <div>
    <a href="/gardenbot/obs.html/tags/index.html" title="Open tag view">
            <img src = "/gardenbot/obs.html/static/hashtag.svg" alt="RSS Feed link" style="width: 24px; margin-left: -2px; margin-top: -2px;"/>
    </a>
</div>
                            
                    </div>
                    <div style="display: flex; flex-direction:column">
                        <div id="left_pane_toggle_nav" class="left_pane_toggle_nav">Toggle Directory Tree Pane</div>
                        <div id="right_pane_toggle_nav" class="right_pane_toggle_nav">Toggle Table of Contents Pane</div>
                    </div>
            </div>
    </div>
    <div class="popup" id="theme-popup">
    <label for="cars">Theme </label>

    <select name="theme" id="theme" onchange="set_theme(this.value)">
      <option value="obs-light" selected="selected">obsidian-light</option>
      <option value="obs-dark">obsidian-dark</option>
    </select> 
</div>
</div>
                <div class="flex_row">
                        <div id="left_pane" class="left_pane active">
    <div id="left_pane_fold_header" class="left_pane_fold_header fold_header">x</div>
    <div id="left_pane_content" class="left_pane_content">
            <div id="dirtree"><button id="folder-1" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>chassis</button>
<div id="folder-container-1" class="dir-container requires_js " path="/gardenbot/chassis">
	<ul class="dir-list">
		<li><div class="file-icon"></div><a class="" href="/gardenbot/chassis/lower-platform.html"  >lower-platform</a></li>
	</ul>
</div>
<button id="folder-2" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>dimensions</button>
<div id="folder-container-2" class="dir-container requires_js " path="/gardenbot/dimensions">
	<button id="folder-3" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>chain_drive_system</button>
	<div id="folder-container-3" class="dir-container requires_js " path="/gardenbot/dimensions/chain_drive_system">
		<button id="folder-4" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>drive-system-images</button>
		<div id="folder-container-4" class="dir-container requires_js " path="/gardenbot/dimensions/chain_drive_system/drive-system-images">
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/chain_drive_system_nobg.png"  class="external-link">chain_drive_system_nobg.png</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/drive_motor_assembly_nobg.png"  class="external-link">drive_motor_assembly_nobg.png</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/drive_motor_encoder.png"  class="external-link">drive_motor_encoder.png</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/drive_sprocket_with_adapter_and_hardware.png"  class="external-link">drive_sprocket_with_adapter_and_hardware.png</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/sprocket_adapter_and_hardware.png"  class="external-link">sprocket_adapter_and_hardware.png</a></li>
			</ul>
		</div>
		<ul class="dir-list">
		</ul>
	</div>
	<ul class="dir-list">
		<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/main_capture-removebg.png"  class="external-link">main_capture-removebg.png</a></li>
	</ul>
</div>
<button id="folder-5" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>docs</button>
<div id="folder-container-5" class="dir-container requires_js " path="/gardenbot/docs">
	<button id="folder-6" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>formal-docs</button>
	<div id="folder-container-6" class="dir-container requires_js " path="/gardenbot/docs/formal-docs">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/docs/formal-docs/power_system_requirements_specifications.html"  >power_system_requirements_specifications</a></li>
		</ul>
	</div>
	<ul class="dir-list">
	</ul>
</div>
<button id="folder-7" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>systems</button>
<div id="folder-container-7" class="dir-container requires_js active" path="/gardenbot/systems">
	<button id="folder-8" class="dir-button folder_note  " href="/gardenbot/systems/computer-system/computer-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>computer-system</button>
	<div id="folder-container-8" class="dir-container requires_js " path="/gardenbot/systems/computer-system">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/computer-system/computer-nano.html"  >computer-nano</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/computer-system/computer-rpi.html"  >computer-rpi</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/computer-system/computer-rpi-camera.html"  >computer-rpi-camera</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/computer-system/computer-rpi-setup.html"  >computer-rpi-setup</a></li>
		</ul>
	</div>
	<button id="folder-9" class="dir-button folder_note  " href="/gardenbot/systems/drive-system/drive-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>drive-system</button>
	<div id="folder-container-9" class="dir-container requires_js " path="/gardenbot/systems/drive-system">
		<button id="folder-10" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>drive-system-details</button>
		<div id="folder-container-10" class="dir-container requires_js " path="/gardenbot/systems/drive-system/drive-system-details">
			<button id="folder-11" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>drive-system-drawings</button>
			<div id="folder-container-11" class="dir-container requires_js " path="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings">
				<ul class="dir-list">
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/2313n26_corner-machine-bracketl.gif"  class="external-link">2313n26_corner-machine-bracketl.gif</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/amt10-encoder-mount-rev-.pdf"  class="external-link">amt10-encoder-mount-rev-.pdf</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/hex-nut-encoder-adapter-rev-.pdf"  class="external-link">hex-nut-encoder-adapter-rev-.pdf</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/my1060_dimension.webp"  class="external-link">my1060_dimension.webp</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/vclamp-wiring.png"  class="external-link">vclamp-wiring.png</a></li>
				</ul>
			</div>
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/vclamp_datasheet.pdf"  class="external-link">vclamp_datasheet.pdf</a></li>
			</ul>
		</div>
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-motor.html"  >drive-motor</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-motor-controller.html"  >drive-motor-controller</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-motor-encoder-assembly.html"  >drive-motor-encoder-assembly</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-roboclaw-setup.html"  >drive-roboclaw-setup</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-safety.html"  >drive-system-safety</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-wheel-assembly.html"  >drive-system-wheel-assembly</a></li>
		</ul>
	</div>
	<button id="folder-12" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>localization-sysytem</button>
	<div id="folder-container-12" class="dir-container requires_js active" path="/gardenbot/systems/localization-sysytem">
		<button id="folder-13" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>gnss-rtk</button>
		<div id="folder-container-13" class="dir-container requires_js active" path="/gardenbot/systems/localization-sysytem/gnss-rtk">
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/localization-sysytem/gnss-rtk/gnss-rtk-diagram.svg"  class="external-link">gnss-rtk-diagram.svg</a></li>
				<li><div class="file-icon"></div><a class="active current_page_dirtree" href="/gardenbot/systems/localization-sysytem/gnss-rtk/usb-gnss-setup.html"  >usb-gnss-setup</a></li>
			</ul>
		</div>
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/localization-sysytem/localization-system.html"  >localization-system</a></li>
		</ul>
	</div>
	<button id="folder-14" class="dir-button folder_note  " href="/gardenbot/systems/power-system/power-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>power-system</button>
	<div id="folder-container-14" class="dir-container requires_js " path="/gardenbot/systems/power-system">
		<ul class="dir-list">
		</ul>
	</div>
	<button id="folder-15" class="dir-button folder_note  " href="/gardenbot/systems/steering-system/steering-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>steering-system</button>
	<div id="folder-container-15" class="dir-container requires_js " path="/gardenbot/systems/steering-system">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/steering-system/steering-motor-controller.html"  >steering-motor-controller</a></li>
		</ul>
	</div>
	<button id="folder-16" class="dir-button folder_note  " href="/gardenbot/systems/wire-system/wire-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>wire-system</button>
	<div id="folder-container-16" class="dir-container requires_js " path="/gardenbot/systems/wire-system">
		<button id="folder-17" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>wire-diagrams</button>
		<div id="folder-container-17" class="dir-container requires_js " path="/gardenbot/systems/wire-system/wire-diagrams">
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wire-diagrams/12v_battery_system.drawio.svg"  class="external-link">12v_battery_system.drawio.svg</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wire-diagrams/wire-system-24-volt.drawio.svg"  class="external-link">wire-system-24-volt.drawio.svg</a></li>
			</ul>
		</div>
		<button id="folder-18" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>wireviz</button>
		<div id="folder-container-18" class="dir-container requires_js " path="/gardenbot/systems/wire-system/wireviz">
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wireviz/wireviz-w1.svg"  class="external-link">wireviz-w1.svg</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wireviz/wireviz-w2.svg"  class="external-link">wireviz-w2.svg</a></li>
			</ul>
		</div>
		<ul class="dir-list">
		</ul>
	</div>
	<ul class="dir-list">
	</ul>
</div>
<ul class="dir-list">
	<li><div class="file-icon"></div><a class="" href="/gardenbot/index.html"  >Home</a></li>
</ul>
</div>
    </div>
</div>
                        <div class="container">
                                
                <div style="width:100%; text-align: right;display: block;margin: 0.5rem;">
                    <div style="flex:1;display: none;"></div>
                    <div class="breadcrumbs" style="flex:1 ;padding: 0.5rem; width: fit-content;display: inline;border-radius: 0.2rem;">
                        <a href="/gardenbot/" style="color: rgb(var(--normal-text-color));">Home</a> / <span style="color: #666;">systems</span> / <span style="color: #666;">localization-sysytem</span> / <span style="color: #666;">gnss-rtk</span> / <a href="/gardenbot/systems/localization-sysytem/gnss-rtk/usb-gnss-setup.html" >usb-gnss-setup</a>
                    </div>
                </div>
<div class="content"><h1 id="usb-gnss-rtk-receiver-setup">USB GNSS RTK Receiver Setup</h1>
<div class="toc">
<ul>
<li><a href="#usb-gnss-rtk-receiver-setup" class="anchor-link">USB GNSS RTK Receiver Setup</a><ul>
<li><a href="#basic-concepts" class="anchor-link">Basic Concepts</a><ul>
<li><a href="#gnss-rtk-receiver-rover" class="anchor-link">GNSS RTK Receiver (Rover)</a></li>
<li><a href="#base-station" class="anchor-link">Base Station</a></li>
<li><a href="#continuously-operating-reference-stations-cors-network" class="anchor-link">Continuously Operating Reference Stations (CORS) network</a></li>
<li><a href="#linux-machine-ntrip-client" class="anchor-link">Linux Machine NTRIP Client</a></li>
</ul>
</li>
<li><a href="#getting-started-with-rtklib-str2str" class="anchor-link">Getting Started with RTKLIB str2str</a><ul>
<li><a href="#access-rtk-correction-service-and-rtk-correction-data" class="anchor-link">Access RTK correction service and RTK correction data</a></li>
<li><a href="#environment-variables" class="anchor-link">Environment Variables</a></li>
<li><a href="#installing-rtklib" class="anchor-link">Installing RTKLIB</a></li>
<li><a href="#configure-rtk-device-correction-input-and-position-out-methods" class="anchor-link">Configure RTK device correction input and position out methods</a></li>
<li><a href="#creating-a-persistent-label-for-the-rtk-gnss-usb-device" class="anchor-link">Creating a persistent label for the RTK GNSS USB device</a></li>
</ul>
</li>
<li><a href="#extras" class="anchor-link">Extras</a></li>
<li><a href="#questions" class="anchor-link">Questions</a><ul>
<li><a href="#q1-how-do-you-find-the-ntrip-mount-point-for-automatic-cells-or-single-sites" class="anchor-link">Q1. How do you find the NTRIP Mount point for Automatic Cells or Single Sites?</a></li>
</ul>
</li>
<li><a href="#nomenclature" class="anchor-link">Nomenclature</a></li>
</ul>
</li>
</ul>
</div>
<div class="callout callout-work in progess active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Work in progess
</div>
</div>
<div class="callout-content">
<ul>
<li>Initial testing notes <a class="inline-tag" href="/gardenbot/obs.html/tags/WIP/index.html">WIP</a>   </li>
<li><a href="https://www.ardusimple.com/rtk-explained/" class="external-link">https://www.ardusimple.com/rtk-explained/</a>   </li>
<li><a href="http://rtkexplorer.com/" class="external-link">rtkexplorer – Exploring low cost solutions for high precision GPS/GNSS</a>   </li>
<li><a href="https://en.wikipedia.org/wiki/NMEA_0183" class="external-link">https://en.wikipedia.org/wiki/NMEA_0183</a>   </li>
<li><a href="https://incors.in.gov/rtk.aspx" class="external-link">https://incors.in.gov/rtk.aspx</a>   </li>
<li><a href="https://wiki.openmower.de/index.php?title=System_Image#STR2STR_(optional,_recommended;_only_needed_if_you're_using_NTRIP,_so_probably_most_of_you)" class="external-link">open mower ntrip</a>   </li>
<li><a href="https://ntrip-list.com/" class="external-link">https://ntrip-list.com/</a>   </li>
<li><a href="http://reach.local" class="external-link">http://reach.local</a>   </li>
<li><a href="https://github.com/rtklibexplorer/RTKLIB" class="external-link" class="external-link">https://github.com/rtklibexplorer/RTKLIB</a>   </li>
<li><a href="https://packages.ubuntu.com/search?keywords=rtklib" class="external-link">https://packages.ubuntu.com/search?keywords=rtklib</a>   </li>
<li><a href="http://magnav.mit.edu/" class="external-link">http://magnav.mit.edu/</a>   </li>
<li><a href="https://youtu.be/lQuVkbphOog" class="external-link">https://youtu.be/lQuVkbphOog</a></li>
</ul>
</div>
</div>
<p><a href="https://incors.in.gov/" class="external-link">https://incors.in.gov/</a>   </p>
<p>This setup provides a tutorial on how to use a GNSS RTK Receiver, a Linux Machine, and an RTK Correction Service (or Base Station) to access position data with centimeter-level precision. Many GNSS RTK Receivers will connect to an NTRIP Caster directly utilizing its on-board LoRa,WiFi, Bluetooth, or Cellular Modem. However this tutorial is geared towards using a Linux Machine to connect to an NTRIP Caster to receive the RTK Correction Data and then relay the data to the RTK Receiver via USB. This use case is more relevant to a robotic platform that already has access to the Internet or a Local Network with an NTRIP Caster. Main reason to do it this way is because your Linux Machine may already be using a Cellular Modem or Long Distance Wireless Access Point. This would render the wireless capabilities of the RTK Receiver as redundant or less capable than what the Linux machine is using.   </p>
<p><img alt="" src="/gardenbot/systems/localization-sysytem/gnss-rtk/gnss-rtk-diagram.svg" />   </p>
<h2 id="basic-concepts">Basic Concepts</h2>
<h3 id="gnss-rtk-receiver-rover">GNSS RTK Receiver (Rover)</h3>
<p>These devices have recently became available in low-cost forms with comparable performance to higher end products. It is basically a micro-controller with a GNSS antenna and receiver with the capability to run complex calculations that enable it to resolve position data with centimeter precision under the right conditions. The micro-controller may be using a library like <a href="https://github.com/rtklibexplorer/RTKLIB" class="external-link" class="external-link">RTKLIB</a> to perform the calculations. The most important condition for resolving centimeter-level precision is access to RTK corrections from a nearby (approximately 35 km) Base Station.   </p>
<h3 id="base-station">Base Station</h3>
<p>The Base Station is basically a stationary GNSS RTK Receiver that is configured to stream out RTK correction data using a NTRIP Server (COTS products offer this as a single package). A Base Station and Reference Station are synonymous.   </p>
<h3 id="continuously-operating-reference-stations-cors-network">Continuously Operating Reference Stations (CORS) network</h3>
<p>A CORS Network is a collection of GNSS Base stations combined in a single network to provide wider coverage of valid RTK correction data. Recall that RTK correction data is only valid within approximately a 35 km radius of the Base Station. A CORS network may provide convenient access to RTK correction data from the nearest base station. There also exist advance techniques to combine correction data from multiple base stations to provide correction data from a Virtual Reference Station (VRS) to further reduce location error. <a href="https://geo-matching.com/content/the-principles-and-performance-of-cors-network-rtk-and-vrs" class="external-link">See VRS for details</a>   </p>
<h3 id="linux-machine-ntrip-client">Linux Machine NTRIP Client</h3>
<p><a href="https://packages.ubuntu.com/jammy/rtklib" class="external-link">RTKLIB</a> provides a suite of CLIs and GUIs that simplify much of the work. In theory could configure your design to perform the RTK calculations on the Linux Machine. However in this tutorial, the Linux Machine is only used to relay the RTK correction data from the NTRIP Caster to the GNSS RTK Receiver. To do this we use the RTKLIB CLI <code>str2str</code> which enables us to connect to a NTRIP caster as a data input source and a GNSS RTK Receiver has a data output target. This employs our Linux machine as a NTRIP Client. Alternatively, instead of using the RTKLIB CLI, we can use the ROS package <a href="http://wiki.ros.org/ntrip_client" class="external-link">ntrip_client</a>. See OpenMower's <a href="https://github.com/ClemensElflein/open_mower_ros/blob/63f11ded7ed5eafcaaefb1778d315079e11c6fed/src/open_mower/launch/include/_ntrip_client.launch" class="external-link">ntrip_client</a> launch file for further details.   </p>
<h2 id="getting-started-with-rtklib-str2str">Getting Started with RTKLIB str2str</h2>
<ol>
<li>Open a terminal and enter the following command to capture the serial port device label e.g. <code>/dev/tty*</code> <a href="https://en.wikipedia.org/wiki/Serial_port#Hardware_abstraction" class="external-link">More info</a>   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>dmesg --follow
</code></pre></div>


</div>

<ol>
<li>Plugin in the USB RTK module and on the Linux terminal you should see this something like the following:    </li>
</ol>
<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code>[604400.525618] cdc_acm 1-1.3:1.0: ttyACM0: USB ACM device
                                   ^^^^^^^ make note of this label
</code></pre></div>


</div>

<div class="callout callout-note active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Note
</div>
</div>
<div class="callout-content">
<p>If you're using a terminal within a docker container you may need to try running the <br />
container in "privileged" mode. This is consider unsafe in some circumstances so you may look <a href="#TODO" class="anchor-link">here</a> for details on how to expose serial interfaces more securely.</p>
</div>
</div>
<ol>
<li>Cancel the process from step 0. In the terminal, enter the following.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo screen /dev/ttyACM0 <span class="m">9600</span>
</code></pre></div>


</div>

<p>or   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo cutecom
</code></pre></div>


</div>

<ol>
<li>You should be able to observe <a href="http://lefebure.com/articles/nmea-gga/" class="external-link" class="external-link">NMEA strings</a> streamed to the terminal. If not, your device may need to be manually configured to do so. One, alternative method is to configure the GNSS receiver to output data via TCP. Enter the either the following commands to observe the data stream.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>nc <span class="m">192</span>.168.0.20:9002
</code></pre></div>


</div>

<p>or   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>socat - TCP4:192.168.0.20:9002
</code></pre></div>


</div>

<ol>
<li>The <code>str2str</code> rtklib CLI application is use to connect to a NTRIP Caster and receive correction data.    </li>
</ol>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code>$ sudo ./str2str -in ntrip://username:password@hostname:port/mountpoint -out serial://ttyACM0:115200#52001 -b <span class="m">1</span>
</code></pre></div>


</div>

<h3 id="access-rtk-correction-service-and-rtk-correction-data">Access RTK correction service and RTK correction data</h3>
<ul>
<li>If your using a RTK correction service then we need a convenient way to store the login credentials securely. This is can be done with Environment Variables   </li>
<li>Alternatively you can set up your own base station (this requires an additional Receiver that can stream out RTK corrections).   </li>
<li>Each method will perform similarly. The limitations of each will be based on the following:   </li>
</ul>
<table>
<thead>
<tr>
<th>Method</th>
<th>Base Station Coverage</th>
<th>Cost</th>
</tr>
</thead>
<tbody>
<tr>
<td>RTK Service</td>
<td>Typically Statewide</td>
<td>Free or Subscription (depending on state)</td>
</tr>
<tr>
<td>RTK Base station</td>
<td>6 mi (single band) 36 mi (multi-band)</td>
<td>+$300 for additional receiver and antenna</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="environment-variables">Environment Variables</h3>
<p><a href="https://www.linode.com/docs/guides/how-to-set-linux-environment-variables/" class="external-link">https://www.linode.com/docs/guides/how-to-set-linux-environment-variables/</a>   </p>
<ol>
<li>Open new terminal,  and append the <code>.bashrc</code> file with the following template and overwriting the characters with <code>...</code>    </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo vim ~/.bashrc
</code></pre></div>


</div>

<div class="callout callout-warning active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
</div>
<div class="callout-title-name">Warning
</div>
</div>
<div class="callout-content">
<p>Note login credentials environment variables have been omitted. Use this snippet as a template. Be careful <strong>NOT</strong> to upload theses to the internet. This should pasted at the bottom of the .bashrc file of the Linux machine. This will create permanent environment variables to store RTK correction service login credentials. This template has two separate ports and endpoints for connecting to a network that automatically selects a reference station and one for connecting a specific reference station.</p>
</div>
</div>
<div class="callout callout-info active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
</div>
<div class="callout-title-name">Info
</div>
</div>
<div class="callout-content">
<p>If you prefer not to store secrets as environment variables <a href="https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html#32-where-should-a-secret-be" class="external-link">OWSAP recommends</a> using secrets-manager such as:   </p>
<blockquote>
<p><a href="https://aws.amazon.com/secrets-manager/" class="external-link">AWS Secret Manager</a>, <a href="https://azure.microsoft.com/nl-nl/services/key-vault/" class="external-link">Azure Key Vault</a>, <a href="https://cloud.google.com/secret-manager" class="external-link">Google Secret Manager</a>), or other third-party facilities (<a href="https://www.vaultproject.io/" class="external-link">Hashicorp Vault</a>, <a href="https://www.conjur.org/" class="external-link">Conjur</a>, <a href="https://www.keepersecurity.com/" class="external-link">Keeper</a>, <a href="https://lyft.github.io/confidant/" class="external-link">Confidant</a>) <br />
<br />
In this project I am using <a href="https://infisical.com/infisical-vs-hashicorp-vault" class="external-link">infisical</a></p>
</blockquote>
</div>
</div>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code><span class="c1"># InCORS RTK correction service credentials https://incors.in.gov/</span>
<span class="c1"># Save the environment variables to to .bashrc i.e `sudo vim ~/.bashrc`</span>
<span class="c1">#########################################################</span>
<span class="c1"># DO NOT PUBLISH, THIS CONTAINS USERNAMES and PASSWORDS #</span>
<span class="c1">#########################################################</span>
<span class="nb">export</span> <span class="nv">NT_HOSTNAME</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
<span class="c1"># Automatic cells</span>
<span class="nb">export</span> <span class="nv">NT_PORT_AUTO</span><span class="o">=</span><span class="s1">&#39;9000&#39;</span>
<span class="nb">export</span> <span class="nv">NT_ENDPOINT_AUTO</span><span class="o">=</span><span class="s1">&#39;RTCM3_MAX&#39;</span>
<span class="c1"># single site</span>
<span class="nb">export</span> <span class="nv">NT_PORT_SINGLE</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
<span class="nb">export</span> <span class="nv">NT_ENDPOINT_SINGLE</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
<span class="c1"># secret</span>
<span class="nb">export</span> <span class="nv">NT_USER</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
<span class="nb">export</span> <span class="nv">NT_PASSWORD</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
</code></pre></div>


</div>

<ol>
<li>After saving edits, close the terminal then run <code>source ~/.bahsrc</code>   </li>
<li>Verify environment variables   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code><span class="nb">echo</span> -e <span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip hostname:        &#39;</span> <span class="nv">$NT_HOSTNAME</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip port_auto:       &#39;</span> <span class="nv">$NT_PORT_AUTO</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip endpoint_auto:   &#39;</span> <span class="nv">$NT_ENDPOINT_AUTO</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip port_sigle:      &#39;</span> <span class="nv">$NT_PORT_SINGLE</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip endpoint_single: &#39;</span> <span class="nv">$NT_ENDPOINT_SINGLE</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip user:            &#39;</span> <span class="nv">$NT_USER</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;nitrip password:       &#39;</span> <span class="nv">$NT_PASSWORD</span>
</code></pre></div>


</div>

<hr />
<h3 id="installing-rtklib">Installing RTKLIB</h3>
<ol>
<li>In the terminal install the rtklib   </li>
</ol>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code>sudo apt install rtklib
</code></pre></div>


</div>

<ol>
<li>
<p>Attempt to receive RTK corrections.   </p>
</li>
<li>
<p>Single Site   </p>
</li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in <span class="se">\</span>
ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_SINGLE</span>/<span class="nv">$NT_ENDPOINT_SINGLE</span><span class="c1">#rtcm3</span>
</code></pre></div>


</div>

<ul>
<li>Automatic Site   </li>
</ul>
<div class="callout callout-warning active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
</div>
<div class="callout-title-name">Warning
</div>
</div>
<div class="callout-content">
<p>Automatic site requires communication with a <strong>GNSS RTK Receiver</strong> in order to automatically send you correction data from the nearest site (end point). Since there is NO target <code>-out</code> parameter provided in the example below str2str will timeout as it waits to recieve GNSS cordinate data. In this case the <code>-in</code> <code>-out</code> abstraction is not strictly applicable since the data is being exchanged both directions between server and client.</p>
</div>
</div>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in <span class="se">\</span>
ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_AUTO</span>/<span class="nv">$NT_ENDPOINT_AUTO</span><span class="c1">#rtcm3</span>
</code></pre></div>


</div>

<h3 id="configure-rtk-device-correction-input-and-position-out-methods">Configure RTK device correction input and position out methods</h3>
<p>This project is using the <a href="https://docs.emlid.com/reach/reference/specifications/reach-module-specs/" class="external-link">Emlid Reach RTK Module</a> and following <a href="https://docs.emlid.com/reach/" class="external-link">documentation</a>. The Emlid is configured with the following settings   </p>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code><span class="k">[details=&quot;Simple system report&quot;]</span><span class="w"></span>
<span class="na">app version: 28.4-r0</span><span class="w"></span>
<span class="na">enabled: true</span><span class="w"></span>
<span class="na">mode: client</span><span class="w"></span>
<span class="na">correction_input:</span><span class="w"></span>
<span class="w">  </span><span class="na">base_corrections:</span><span class="w"></span>
<span class="w">    </span><span class="na">io_type: serial</span><span class="w"></span>
<span class="w">    </span><span class="na">settings:</span><span class="w"></span>
<span class="w">      </span><span class="na">serial:</span><span class="w"></span>
<span class="w">        </span><span class="na">baud_rate: 115200</span><span class="w"></span>
<span class="w">        </span><span class="na">device: ttyGS0 (USB-to-PC)</span><span class="w"></span>
<span class="w">        </span><span class="na">send_position_to_base: true</span><span class="w"></span>
<span class="na">position_output:</span><span class="w"></span>
<span class="w">  </span><span class="na">output1:</span><span class="w"></span>
<span class="w">    </span><span class="na">io_type: serial</span><span class="w"></span>
<span class="w">    </span><span class="na">nmea_settings:</span><span class="w"></span>
<span class="w">      </span><span class="na">serial:</span><span class="w"></span>
<span class="w">        </span><span class="na">gga:</span><span class="w"></span>
<span class="w">          </span><span class="na">enabled: true</span><span class="w"></span>
<span class="w">          </span><span class="na">update_rate: 1</span><span class="w"></span>
<span class="w">        </span><span class="na">gsa:</span><span class="w"></span>
<span class="w">          </span><span class="na">enabled: false</span><span class="w"></span>
<span class="w">          </span><span class="na">update_rate: 1</span><span class="w"></span>
<span class="w">        </span><span class="na">gst:</span><span class="w"></span>
<span class="w">          </span><span class="na">enabled: false</span><span class="w"></span>
<span class="w">          </span><span class="na">update_rate: 1</span><span class="w"></span>
<span class="w">        </span><span class="na">gsv:</span><span class="w"></span>
<span class="w">          </span><span class="na">enabled: false</span><span class="w"></span>
<span class="w">          </span><span class="na">update_rate: 1</span><span class="w"></span>
<span class="w">        </span><span class="na">main_talker_id: gn</span><span class="w"></span>
<span class="w">        </span><span class="na">rmc:</span><span class="w"></span>
<span class="w">          </span><span class="na">enabled: false</span><span class="w"></span>
<span class="w">          </span><span class="na">update_rate: 1</span><span class="w"></span>
<span class="w">        </span><span class="na">vtg:</span><span class="w"></span>
<span class="w">          </span><span class="na">enabled: false</span><span class="w"></span>
<span class="w">          </span><span class="na">update_rate: 1</span><span class="w"></span>
<span class="w">        </span><span class="na">zda:</span><span class="w"></span>
<span class="w">          </span><span class="na">enabled: false</span><span class="w"></span>
<span class="w">          </span><span class="na">update_rate: 1</span><span class="w"></span>
<span class="w">    </span><span class="na">settings:</span><span class="w"></span>
<span class="w">      </span><span class="na">serial:</span><span class="w"></span>
<span class="w">        </span><span class="na">baud_rate: 9600</span><span class="w"></span>
<span class="w">        </span><span class="na">device: ttyGS0 (USB-to-PC)</span><span class="w"></span>
<span class="w">        </span><span class="na">format: NMEA</span><span class="w"></span>
<span class="na">positioning_settings:</span><span class="w"></span>
<span class="w">  </span><span class="na">elevation_mask_angle: 15</span><span class="w"></span>
<span class="w">  </span><span class="na">glonass_ar_mode: true</span><span class="w"></span>
<span class="w">  </span><span class="na">gnss_settings:</span><span class="w"></span>
<span class="w">    </span><span class="na">positioning_systems:</span><span class="w"></span>
<span class="w">      </span><span class="na">beidou: false</span><span class="w"></span>
<span class="w">      </span><span class="na">galileo: true</span><span class="w"></span>
<span class="w">      </span><span class="na">glonass: true</span><span class="w"></span>
<span class="w">      </span><span class="na">gps: true</span><span class="w"></span>
<span class="w">      </span><span class="na">qzss: true</span><span class="w"></span>
<span class="w">      </span><span class="na">sbas: true</span><span class="w"></span>
<span class="w">    </span><span class="na">update_rate: 5</span><span class="w"></span>
<span class="w">  </span><span class="na">gps_ar_mode: fix-and-hold</span><span class="w"></span>
<span class="w">  </span><span class="na">max_horizontal_acceleration: 1</span><span class="w"></span>
<span class="w">  </span><span class="na">max_vertical_acceleration: 1</span><span class="w"></span>
<span class="w">  </span><span class="na">positioning_mode: kinematic</span><span class="w"></span>
<span class="w">  </span><span class="na">snr_mask: 35</span><span class="w"></span>
<span class="k">[/details]</span><span class="w"></span>
</code></pre></div>


</div>

<h3 id="creating-a-persistent-label-for-the-rtk-gnss-usb-device">Creating a persistent label for the RTK GNSS USB device</h3>
<p>To use the serial device as non-root user, udev rules must be installed.   </p>
<div class="callout callout-caution active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
</div>
<div class="callout-title-name">Caution
</div>
</div>
<div class="callout-content">
<p>This serial interface label e.g. <code>ttyACM0</code> is liable to change depending on various reasons. <br />
The following commands will be used create a persistent label for serial port device and enable use by a non-root user. <br />
<br />
- <a href="http://reactivated.net/writing_udev_rules.html?#example-printer" class="external-link">http://reactivated.net/writing_udev_rules.html?#example-printer</a> <br />
- <a href="http://weng-blog.com/2017/05/udev-rule/" class="external-link">http://weng-blog.com/2017/05/udev-rule/</a> <br />
</p>
</div>
</div>
<ol>
<li>Open a terminal and enter the following follow commands.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>lsusb
</code></pre></div>


</div>

<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code>Bus 003 Device 063: ID 3032:0014 Emlid Reach
                       ^^^^ ^^^^
                    vendor  product
</code></pre></div>


</div>

<ol>
<li>On the Linux terminal you should see this something like the following:   </li>
</ol>
<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code>[604400.525618] cdc_acm 1-1.3:1.0: ttyACM0: USB ACM device
                                   ^^^^^^^ make note of this label
</code></pre></div>


</div>

<ol>
<li><a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a>   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>udevadm info -q all -n /dev/ttyACM0
</code></pre></div>


</div>

<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code><span class="n">P</span><span class="p">:</span> <span class="o">/</span><span class="n">devices</span><span class="o">/</span><span class="n">pci0000</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">0000</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">14.0</span><span class="o">/</span><span class="n">usb3</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mf">1.2</span><span class="o">/</span><span class="n">tty</span><span class="o">/</span><span class="n">ttyACM0</span>
<span class="n">N</span><span class="p">:</span> <span class="n">ttyACM0</span>
<span class="p">....</span>
<span class="n">E</span><span class="p">:</span> <span class="n">DEVPATH</span><span class="o">=/</span><span class="n">devices</span><span class="o">/</span><span class="n">pci0000</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">0000</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">14.0</span><span class="o">/</span><span class="n">usb3</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mf">1.2</span><span class="o">/</span><span class="n">tty</span><span class="o">/</span><span class="n">ttyACM0</span>
<span class="n">E</span><span class="p">:</span> <span class="n">DEVNAME</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span>
<span class="n">E</span><span class="p">:</span> <span class="n">MAJOR</span><span class="o">=</span><span class="mi">166</span>
<span class="n">E</span><span class="p">:</span> <span class="n">MINOR</span><span class="o">=</span><span class="mi">0</span>
<span class="n">E</span><span class="p">:</span> <span class="n">SUBSYSTEM</span><span class="o">=</span><span class="n">tty</span>       <span class="o">&lt;-----------</span> <span class="n">make</span> <span class="n">note</span> <span class="n">of</span> <span class="n">this</span> <span class="n">label</span>
<span class="n">E</span><span class="p">:</span> <span class="n">USEC_INITIALIZED</span><span class="o">=</span><span class="mi">166592821213</span>
<span class="n">E</span><span class="p">:</span> <span class="n">ID_BUS</span><span class="o">=</span><span class="n">usb</span>
<span class="n">E</span><span class="p">:</span> <span class="n">ID_VENDOR_ID</span><span class="o">=</span><span class="mi">3032</span>   <span class="o">&lt;------------</span>
<span class="n">E</span><span class="p">:</span> <span class="n">ID_MODEL_ID</span><span class="o">=</span><span class="mi">0014</span>    <span class="o">&lt;------------</span>
<span class="n">E</span><span class="p">:</span> <span class="n">ID_PCI_CLASS_FROM_DATABASE</span><span class="o">=</span><span class="n">Serial</span> <span class="n">bus</span> <span class="n">controller</span>
<span class="p">....</span>
</code></pre></div>


</div>

<ol>
<li><a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a>   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code><span class="nb">cd</span> /etc/udev/rules.d/<span class="p">;</span>
sudo vim <span class="m">51</span>-emlid.rules
</code></pre></div>


</div>

<div class="lang-shell">

<div class="codehilite"><pre><span></span><code><span class="c1"># Copy this udev with &quot;sudo cp 51-emlid.rules /etc/udev/rules.d/&quot;</span>
<span class="c1"># When done, do &quot;sudo udevadm control --reload &amp;&amp; sudo udevadm trigger&quot;</span>
<span class="c1"># Edit it to suit your type of Linux. It&#39;s currently set up for modern Ubuntu</span>
ATTRS<span class="o">{</span>idProduct<span class="o">}==</span><span class="s2">&quot;0014&quot;</span>, ATTRS<span class="o">{</span>idVendor<span class="o">}==</span><span class="s2">&quot;3032&quot;</span>, MODE:<span class="o">=</span><span class="s2">&quot;666&quot;</span>, <span class="nv">GROUP</span><span class="o">=</span><span class="s2">&quot;plugdev&quot;</span>, <span class="nv">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;tty&quot;</span>, <span class="nv">SYMLINK</span><span class="o">+=</span><span class="s2">&quot;emlid_rtk&quot;</span>
</code></pre></div>


</div>

<ol>
<li><a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a>   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo udevadm control --reload <span class="o">&amp;&amp;</span> sudo udevadm trigger
</code></pre></div>


</div>

<p>Re-plug in USB GNSS receiver and verify <a href="http://lefebure.com/articles/nmea-gga/" class="external-link" class="external-link">NMEA strings</a> streamed to the terminal   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo screen /dev/emlid_rtk
</code></pre></div>


</div>

<ol>
<li>
<p>Run the <code>str2str</code> rtklib CLI application   </p>
</li>
<li>
<p>To receive <strong>Single site</strong> corrections via NTRIP and relay to USB GNSS receiver via serial   </p>
</li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in <span class="se">\</span>
ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_SINGLE</span>/<span class="nv">$NT_ENDPOINT_SINGLE</span><span class="c1">#rtcm3 \</span>
-out serial://emlid_rtk:115200#52001 -b <span class="m">1</span>
</code></pre></div>


</div>

<ul>
<li>Alt. to Receive <strong>Automatic cell</strong> corrections via NTRIP and relay to USB GNSS receiver via serial   </li>
</ul>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in <span class="se">\</span>
ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_AUTO</span>/<span class="nv">$NT_ENDPOINT_AUTO</span><span class="c1">#rtcm3 \</span>
-out serial://emlid_rtk:115200#52001 -b <span class="m">1</span>
</code></pre></div>


</div>

<ol>
<li>Listen   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>nc localhost <span class="m">52001</span>
</code></pre></div>


</div>

<h2 id="extras">Extras</h2>
<ul>
<li>Set trace level with <code>-t 3</code> and you can read logs with <code>cat str2str.trace</code>   </li>
</ul>
<div class="lang-sh">

<div class="codehilite"><pre><span></span><code>str2str -in <span class="se">\</span>
ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_SINGLE</span>/<span class="nv">$NT_ENDPOINT_SINGLE</span><span class="c1">#rtcm3 \</span>
-t <span class="m">3</span>
</code></pre></div>


</div>

<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>cat str2str.trace
</code></pre></div>


</div>

<h2 id="questions">Questions</h2>
<h3 id="q1-how-do-you-find-the-ntrip-mount-point-for-automatic-cells-or-single-sites">Q1. How do you find the NTRIP Mount point for Automatic Cells or Single Sites?</h3>
<ol>
<li>The service provide may have a number of resources such as a tables specifying the connection details or and interactive map of the CORs Network.   </li>
<li>With a given <strong>IP address</strong> and <strong>Port</strong> you can use <code>str2str -in ntrip://&lt;ip&gt;:&lt;port&gt;</code> to return a <strong>Source Table</strong> with the 2nd data field specifying the mount point. <a href="https://software.rtcm-ntrip.org/wiki/STR" class="external-link">For more info see</a>   </li>
<li>There are also several tools that enable you browse the available mount points on such as <a href="http://monitor.use-snip.com/" class="external-link">http://monitor.use-snip.com/</a>  or <a href="https://www.rtklib.com/prog/manual_2.4.2.pdf#page=85" class="external-link">srctblbrows.exe</a>   </li>
</ol>
<h2 id="nomenclature">Nomenclature</h2>
<p><a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a>   </p>
<p>Source Table: Represents contents list of provided data by NTRIP servers</p></div>
<div class="note-footer">
<div class="backlinks">
<h2>Backlinks</h2>
<ul>
	<li><a class="backlink" href="/gardenbot/systems/localization-sysytem/localization-system.html">localization-system</a></li>
</ul>
</div>

<div class="tags">
<h2>Tags</h2>
<ul>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/WIP/index.html">WIP</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/todo/index.html">todo</a></li>
</ul>
</div>

</div>
<div class="graph requires_js ">
    <div id="A283980547125594467674267558908870302562{level}" class="graph_div"></div>

    <div class="graph-instructions" id="D283980547125594467674267558908870302562{level}">
        Left-click: follow link, Right-click: select node, Scroll: zoom
    </div>
    
    <div class="graph-button-row" style="display:flex;">
        <button class="graph_button graph_show_button" id="B283980547125594467674267558908870302562{level}" level="{level}" note_temp_id="283980547125594467674267558908870302562" onclick="window.ObsHtmlGraph.run(this, '283980547125594467674267558908870302562', 'usb-gnss-setup');">
            Show Graph
        </button>
        <button class="graph_button graph_type_button" id="C283980547125594467674267558908870302562{level}" style="flex:1" onclick="window.ObsHtmlGraph.switch_graph_type(this);">
            2D
        </button>
    </div>
</div>

<script type="module">
    if (window.ObsHtmlGraph == undefined){
        import('/gardenbot/obs.html/static/graph.js').then((Module) => {
            window.ObsHtmlGraph = Module;
            window.ObsHtmlGraph.arm_page(document.getElementById('page_holder'))
        })
    }
</script>




                                <!-- end content -->
                        </div>
                        <div class="container_filler">
                        </div>
                        <div id="right_pane" class="right_pane active">
    <div id="right_pane_fold_header" class="right_pane_fold_header fold_header">x</div>
    <div id="right_pane_content" class="right_pane_content">
            
    </div>
</div>
                </div>
        </div>

        <script>
                function handle_toggle_side_bar(e){
                        let header;
                        let pane; 
                        let target = e.target

                        // switch out the navbar button click for a header click
                        if (target.id == 'left_pane_toggle_nav'){
                                target = document.getElementById('left_pane_fold_header')
                        }
                        else if (target.id == 'right_pane_toggle_nav'){
                                target = document.getElementById('right_pane_fold_header')
                        }

                        // get header and pane
                        if (target.classList.contains('fold_header')) {
                                header = target;
                                pane = target.parentElement;
                        }
                        else {
                                pane = target;
                                header = target.getElementsByClassName('fold_header')[0];
                        }
                        toggle_side_bar(pane, header, true)
                        e.stopPropagation();
                }
                function handle_toggle_side_bar_button(e){
                        document.getElementById('menu_toggle_button').click()
                        handle_toggle_side_bar(e);
                }

                function toggle_side_bar(pane, header, save) {
                        let active = (pane.classList.contains('active'))
                        if (active){
                                disable_side_bar(pane, header, save);
                        }
                        else {
                                enable_side_bar(pane, header, save);
                        }
                }
                function enable_side_bar(pane, header, save){
                        pane.classList.add('active');
                        pane.removeEventListener('click', handle_toggle_side_bar);
                        header.addEventListener('click', handle_toggle_side_bar);
                        set_correct_header_symbol(header);
                        if (save){ save_panel_folding_state(header, true) }
                }
                function disable_side_bar(pane, header, save){
                        pane.classList.remove('active');
                        pane.addEventListener('click', handle_toggle_side_bar);
                        header.removeEventListener('click', handle_toggle_side_bar);
                        set_correct_header_symbol(header);
                        if (save){ save_panel_folding_state(header, false) }
                }
                function set_correct_header_symbol(header){
                        let pane = header.parentElement;
                        let symbol = [['>', '<'],['<', '>']]
                        symbol = symbol[Number(header.classList.contains('right_pane_fold_header'))][Number(pane.classList.contains('active'))];
                        console.log(symbol);
                        header.innerHTML = symbol
                        return header;
                }
                function panel_folding_get_panel_name(header){
                        return ['left', 'right'][Number(header.classList.contains('right_pane_fold_header'))]
                }
                function save_panel_folding_state(header, active){
                        ls_set('pane_folding_state_'+panel_folding_get_panel_name(header), Number(active));
                }
                function load_panel_folding_state(panel_name){
                        val = ls_get('pane_folding_state_'+panel_name)
                        if (!val){ return {'exists': false, 'value': null}}
                        return {'exists': true, 'value': Boolean(Number(val))}
                }
                function set_pane_folding_start(left_header, right_header){
                        // small screen = closed
                        let right_pane_enabled = true;
                        let left_pane_enabled = true;
                        let w = window.visualViewport.width
                        if (w < 1000){
                                left_pane_enabled = false
                        }
                        if (w < 800){
                                right_pane_enabled = false
                        }

                        // get saved values if present
                        let rval = load_panel_folding_state('right')
                        if (rval['exists']){
                                right_pane_enabled = rval['value']
                        }
                        let lval = load_panel_folding_state('left')
                        if (lval['exists']){
                                left_pane_enabled = lval['value']
                        }

                        // default = enabled, so we only need to disable
                        if (!left_pane_enabled){
                                disable_side_bar(document.getElementById('left_pane'), document.getElementById('left_pane_fold_header'))
                        }
                        if (!right_pane_enabled){
                                disable_side_bar(document.getElementById('right_pane'), document.getElementById('right_pane_fold_header'))
                        }
                }

                function init_pane_folding(header){
                        set_correct_header_symbol(header);
                        header.addEventListener('click', handle_toggle_side_bar);
                }
                
                
                set_pane_folding_start()
                init_pane_folding(document.getElementById('left_pane_fold_header'));
                init_pane_folding(document.getElementById('right_pane_fold_header'));

                document.getElementById('left_pane_toggle_nav').addEventListener('click', handle_toggle_side_bar_button);
                document.getElementById('right_pane_toggle_nav').addEventListener('click', handle_toggle_side_bar_button);
        </script>

        <script src="/gardenbot/obs.html/static/load_dirtree_footer.js" type="text/javascript"></script>

        




</body>
</html>
