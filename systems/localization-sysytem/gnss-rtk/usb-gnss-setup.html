<!DOCTYPE html>

<html lang="en">

        <head>
                <!-- Page information -->
                <meta charset="UTF-8" />
                <meta name="node_id" content="usb-gnss-setup">
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <link rel="shortcut icon" href="/gardenbot/favicon.ico" />

                <!-- Set title -->
                <title>gardenbot/notes</title>

                <!-- Includes -->
                <script src="/gardenbot/obs.html/static/obsidian_core.js"></script>
<script src="/gardenbot/obs.html/static/encoding.js"></script>
<link rel="stylesheet" href="/gardenbot/obs.html/static/master.css" />
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
            'securityLevel': 'loose',
            'theme': 'dark',
            'themeVariables': {
                    'darkMode': true,
            }
    });
</script>
<script>
  MathJax = {
    loader: {
      load: [
        '[tex]/action',
        'output/chtml',
        '[tex]/centernot'
      ]
    },
    tex: {
      inlineMath: [ ["\\(","\\)"] ],
      displayMath: [ ["\\[","\\]"] ],
      processEscapes: true,
      processEnvironments: true,
      packages: {'[+]': ['centernot']}
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<script src="/gardenbot/obs.html/static/flexsearch.bundle.js"></script>
<script src="/gardenbot/obs.html/static/pako.js"></script>
<script src="/gardenbot/obs.html/static/search.js"></script>
<script src="/gardenbot/obs.html/static/dirtree.js"></script>




                <!-- Onload tweaks -->
                <script>
                        const CURRENT_NODE = 'usb-gnss-setup';
                        const HTML_URL_PREFIX = '/gardenbot';
                        const PAGE_DEPTH = 3;
                </script>
        </head>

<body class="theme-obs-light">
        <div id="antiflash" style="display: none;"></div>
        <script>
                document.getElementById('antiflash').style.display = 'block';
        </script>
        <div id="search-master-div">
    <div id="search-slab" king_ramses="return the slaaab">
            <div id="search-controls">
                    <input id="search_string" placeholder="Type to search notes" type="text" />
                    <div class="tooltip" style="display: none;">
                        <input type="checkbox" id="hard_search" name="hard" />
                        <span class="tooltiptext">Hard search (require exact match)</span>
                    </div>
                    <div id="search-results-box">
                        <div id="search-results"></div>
                    </div>
                    <div id="search-instructions">
                        <div class="prompt-instruction mobile">
                            <button onclick="toggle_id('search-master-div');"><b>Close</b> Search </button>
                        </div>
                    </div>
            </div>
    </div>
</div>

<script>
    document.getElementById("search-master-div").addEventListener('click', e => {
            if(e.target !== e.currentTarget){
                    return
            }
            toggle_id('search-master-div');
    })
    document.getElementById("search_string").addEventListener("input", function(event) {
            setTimeout( () =>run_search('search_string', 'hard_search'), 100 );
    }); 
    document.getElementById("hard_search").addEventListener("click", function(event) {
            setTimeout( () =>run_search('search_string', 'hard_search'), 100 );
    });

    window.addEventListener('keydown', e => {
        if((e.key=='Escape'||e.key=='Esc'||e.keyCode==27)){
            toggle_id('search-master-div');
            return false;
        } 
    }, true);

    function click_list_link(element){
        element.parentElement.getElementsByTagName('a')[0].click()
    }
</script>

        <div id="page_holder" class="flex_col">
                <div id="header" class="header">
    <div id="header_flex" class="flex_row">
            <a href="/gardenbot/index.html" id="homelink" title="Clear screen and go to homepage">gardenbot/notes</a>
            <div id="menu_toggle_button" class="navbar-button requires_js" onclick="toggle_menu()">
                    ≡
            </div>
            <div id="navbar" class="navbar requires_js">
                    <a class="navbar-link" href="/gardenbot/index.html" title="Home">Home</a>
<a class="navbar-link" href="/gardenbot/systems/wire-system/wire-system.html" title="Wiring">Wiring</a>
<a class="navbar-link" href="/gardenbot/systems/localization-sysytem/gnss-rtk/usb-gnss-setup.html" title="GNSS RTK">GNSS RTK</a>
<a class="navbar-link" href="/gardenbot/systems/drive-system/drive-roboclaw-setup.html" title="Drive Motors">Drive Motors</a>
<a class="navbar-link" href="/gardenbot/systems/power-system/power-system.html" title="Power System">Power System</a>
<a class="navbar-link" href="/gardenbot/systems/computer-system/computer-rpi.html" title="Computer System">Computer System</a>
                    <div class="icon-tray">
                            <div id="theme-button" class="theme-button requires_js" title="Change theme" onclick="toggle_theme_popup(this)">
    T
</div>
<script>
    function toggle_theme_popup(el){
        // make theme button show that it's active by adding the .active class
        toggle(el);

        // show the theme selector
        toggle_id('theme-popup')

        let h2 = document.getElementById('header2')
        if (h2){
            let pu = document.getElementById('header2').getElementsByClassName('popup')[0];
            toggle(pu);
        }
    }

    function disable_theme_popup(){
        disable_id('theme-button');

        // show the theme selector
        disable_id('theme-popup')

        let h2 = document.getElementById('header2')
        if (h2){
            let pu = document.getElementById('header2').getElementsByClassName('popup')[0];
            disable(pu);
        }
    }
</script>
                                    <div onclick="openSearch()" class="theme-button requires_js">
            <img src = "/gardenbot/obs.html/static/search.svg" alt="Search notes" title="Search notes" style="margin: 4px;"/>
        </div>
        <script>
            function openSearch(){
                // toggle search popup and continue with extra code if it is enabled this time
                if (toggle_id('search-master-div')){
                    // get input field and temporarily disable it
                    let ss = document.getElementById('search_string');
                    ss.value = 'Seach data initializing...';
                    ss.readOnly = true; 

                    // load search data if not yet done so
                    setTimeout(function(){
                        LoadSearchData()

                        // clear input and put focus on it so that we can start typing immediately
                        ss.value = '';
                        ss.readOnly = false; 
                        ss.focus()
                        ss.select()
                    }, 100);
                }
            }
        </script>
                                    <div class="graph_header_div requires_js">
            <a id="graph_link" class="system-link" href="/gardenbot/obs.html/graph/index.html?node=usb-gnss-setup" title="Open fullpage Graph">
                    <img class="graph_header_div_svg" src = "/gardenbot/obs.html/static/graph.svg" alt="Open fullpage Graph" style="margin: 2px; width: 17px;"/>
            </a>
        </div>
                                    <div >
            <a id="dirtree_link" class="system-link" href="/gardenbot/dirtree.html" title="View directory tree">
                    <img src = "/gardenbot/obs.html/static/dirtree.svg" style="width: 12px; padding: 4px;" alt="Directory tree link"/>
            </a>
        </div>
                            <div>
    <a href="/gardenbot/obs.html/tags/index.html" title="Open tag view">
            <img src = "/gardenbot/obs.html/static/hashtag.svg" alt="RSS Feed link" style="width: 24px; margin-left: -2px; margin-top: -2px;"/>
    </a>
</div>
                            
                    </div>
                    <div style="display: flex; flex-direction:column">
                        <div id="left_pane_toggle_nav" class="left_pane_toggle_nav">Toggle Directory Tree Pane</div>
                        <div id="right_pane_toggle_nav" class="right_pane_toggle_nav">Toggle Table of Contents Pane</div>
                    </div>
            </div>
    </div>
    <div class="popup" id="theme-popup">
    <label for="cars">Theme </label>

    <select name="theme" id="theme" onchange="set_theme(this.value)">
      <option value="obs-light" selected="selected">obsidian-light</option>
      <option value="obs-dark">obsidian-dark</option>
    </select> 
</div>
</div>
                <div class="flex_row">
                        <div id="left_pane" class="left_pane active">
    <div id="left_pane_fold_header" class="left_pane_fold_header fold_header">x</div>
    <div id="left_pane_content" class="left_pane_content">
            <div id="dirtree"><button id="folder-1" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>chassis</button>
<div id="folder-container-1" class="dir-container requires_js " path="/gardenbot/chassis">
	<ul class="dir-list">
		<li><div class="file-icon"></div><a class="" href="/gardenbot/chassis/lower-platform.html"  >lower-platform</a></li>
	</ul>
</div>
<button id="folder-2" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>dimensions</button>
<div id="folder-container-2" class="dir-container requires_js " path="/gardenbot/dimensions">
	<button id="folder-3" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>chain_drive_system</button>
	<div id="folder-container-3" class="dir-container requires_js " path="/gardenbot/dimensions/chain_drive_system">
		<button id="folder-4" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>drive-system-images</button>
		<div id="folder-container-4" class="dir-container requires_js " path="/gardenbot/dimensions/chain_drive_system/drive-system-images">
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/chain_drive_system_nobg.png"  class="external-link">chain_drive_system_nobg.png</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/drive_motor_assembly_nobg.png"  class="external-link">drive_motor_assembly_nobg.png</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/drive_motor_encoder.png"  class="external-link">drive_motor_encoder.png</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/drive_sprocket_with_adapter_and_hardware.png"  class="external-link">drive_sprocket_with_adapter_and_hardware.png</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/chain_drive_system/drive-system-images/sprocket_adapter_and_hardware.png"  class="external-link">sprocket_adapter_and_hardware.png</a></li>
			</ul>
		</div>
		<ul class="dir-list">
		</ul>
	</div>
	<ul class="dir-list">
		<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/dimensions/main_capture-removebg.png"  class="external-link">main_capture-removebg.png</a></li>
	</ul>
</div>
<button id="folder-5" class="dir-button folder_note  " href="/gardenbot/docs/docs.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>docs</button>
<div id="folder-container-5" class="dir-container requires_js " path="/gardenbot/docs">
	<button id="folder-6" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>formal-docs</button>
	<div id="folder-container-6" class="dir-container requires_js " path="/gardenbot/docs/formal-docs">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/docs/formal-docs/power_system_requirements_specifications.html"  >power_system_requirements_specifications</a></li>
		</ul>
	</div>
	<button id="folder-7" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>oem-docs</button>
	<div id="folder-container-7" class="dir-container requires_js " path="/gardenbot/docs/oem-docs">
		<ul class="dir-list">
			<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/docs/oem-docs/asin_b08rrtdsfb-_batter-disconnect.pdf"  class="external-link">asin_b08rrtdsfb-_batter-disconnect.pdf</a></li>
			<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/docs/oem-docs/gsw-110.pdf"  class="external-link">gsw-110.pdf</a></li>
			<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/docs/oem-docs/gsw-123.pdf"  class="external-link">gsw-123.pdf</a></li>
			<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/docs/oem-docs/gsw-14.pdf"  class="external-link">gsw-14.pdf</a></li>
			<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/docs/oem-docs/gsw-23.pdf"  class="external-link">gsw-23.pdf</a></li>
		</ul>
	</div>
	<button id="folder-8" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>ref-docs</button>
	<div id="folder-container-8" class="dir-container requires_js " path="/gardenbot/docs/ref-docs">
		<ul class="dir-list">
			<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/docs/ref-docs/metal-gauges-unipunch.pdf"  class="external-link">metal-gauges-unipunch.pdf</a></li>
		</ul>
	</div>
	<ul class="dir-list">
	</ul>
</div>
<button id="folder-9" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>systems</button>
<div id="folder-container-9" class="dir-container requires_js active" path="/gardenbot/systems">
	<button id="folder-10" class="dir-button folder_note  " href="/gardenbot/systems/computer-system/computer-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>computer-system</button>
	<div id="folder-container-10" class="dir-container requires_js " path="/gardenbot/systems/computer-system">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/computer-system/computer-nano.html"  >computer-nano</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/computer-system/computer-rpi.html"  >computer-rpi</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/computer-system/computer-rpi-camera.html"  >computer-rpi-camera</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/computer-system/computer-rpi-setup.html"  >computer-rpi-setup</a></li>
		</ul>
	</div>
	<button id="folder-11" class="dir-button folder_note  " href="/gardenbot/systems/drive-system/drive-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>drive-system</button>
	<div id="folder-container-11" class="dir-container requires_js " path="/gardenbot/systems/drive-system">
		<button id="folder-12" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>drive-system-details</button>
		<div id="folder-container-12" class="dir-container requires_js " path="/gardenbot/systems/drive-system/drive-system-details">
			<button id="folder-13" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>drive-system-drawings</button>
			<div id="folder-container-13" class="dir-container requires_js " path="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings">
				<ul class="dir-list">
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/2313n26_corner-machine-bracketl.gif"  class="external-link">2313n26_corner-machine-bracketl.gif</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/amt10-encoder-mount-rev-.pdf"  class="external-link">amt10-encoder-mount-rev-.pdf</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/flat-pattern-of-encoder-bracket-amt103-drawing-1.pdf"  class="external-link">flat-pattern-of-encoder-bracket-amt103-drawing-1.pdf</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/hex-nut-encoder-adapter-rev-.pdf"  class="external-link">hex-nut-encoder-adapter-rev-.pdf</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/my1060_dimension.webp"  class="external-link">my1060_dimension.webp</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/drive-system-drawings/vclamp-wiring.png"  class="external-link">vclamp-wiring.png</a></li>
				</ul>
			</div>
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-details/vclamp_datasheet.pdf"  class="external-link">vclamp_datasheet.pdf</a></li>
			</ul>
		</div>
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-motor.html"  >drive-motor</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-motor-controller.html"  >drive-motor-controller</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-motor-encoder-assembly.html"  >drive-motor-encoder-assembly</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-roboclaw-setup.html"  >drive-roboclaw-setup</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-safety.html"  >drive-system-safety</a></li>
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/drive-system/drive-system-wheel-assembly.html"  >drive-system-wheel-assembly</a></li>
		</ul>
	</div>
	<button id="folder-14" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>localization-sysytem</button>
	<div id="folder-container-14" class="dir-container requires_js active" path="/gardenbot/systems/localization-sysytem">
		<button id="folder-15" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>gnss-rtk</button>
		<div id="folder-container-15" class="dir-container requires_js active" path="/gardenbot/systems/localization-sysytem/gnss-rtk">
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/localization-sysytem/gnss-rtk/gnss-rtk-diagram.drawio.svg"  class="external-link">gnss-rtk-diagram.drawio.svg</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/localization-sysytem/gnss-rtk/reach-correction-input.png"  class="external-link">reach-correction-input.png</a></li>
				<li><div class="file-icon"></div><a class="active current_page_dirtree" href="/gardenbot/systems/localization-sysytem/gnss-rtk/usb-gnss-setup.html"  >usb-gnss-setup</a></li>
			</ul>
		</div>
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/localization-sysytem/localization-system.html"  >localization-system</a></li>
		</ul>
	</div>
	<button id="folder-16" class="dir-button folder_note  " href="/gardenbot/systems/power-system/power-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>power-system</button>
	<div id="folder-container-16" class="dir-container requires_js " path="/gardenbot/systems/power-system">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/power-system/pisugar.html"  >pisugar</a></li>
			<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/power-system/pisugar-interface.drawio.svg"  class="external-link">pisugar-interface.drawio.svg</a></li>
		</ul>
	</div>
	<button id="folder-17" class="dir-button folder_note  " href="/gardenbot/systems/steering-system/steering-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>steering-system</button>
	<div id="folder-container-17" class="dir-container requires_js " path="/gardenbot/systems/steering-system">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/steering-system/steering-motor-controller.html"  >steering-motor-controller</a></li>
		</ul>
	</div>
	<button id="folder-18" class="dir-button folder_note  " href="/gardenbot/systems/wire-system/wire-system.html" onclick="open_folder_note(this)"><div class="file-icon"></div><div class="fn_pf">*</div>wire-system</button>
	<div id="folder-container-18" class="dir-container requires_js " path="/gardenbot/systems/wire-system">
		<button id="folder-19" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>wire-diagrams</button>
		<div id="folder-container-19" class="dir-container requires_js " path="/gardenbot/systems/wire-system/wire-diagrams">
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wire-diagrams/12v_battery_system.drawio.svg"  class="external-link">12v_battery_system.drawio.svg</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wire-diagrams/power-system-concept.drawio.svg"  class="external-link">power-system-concept.drawio.svg</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wire-diagrams/wire-system-24-volt.drawio.html"  >wire-system-24-volt.drawio.html</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wire-diagrams/wire-system-24-volt.drawio.svg"  class="external-link">wire-system-24-volt.drawio.svg</a></li>
			</ul>
		</div>
		<button id="folder-20" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>wire-parts</button>
		<div id="folder-container-20" class="dir-container requires_js " path="/gardenbot/systems/wire-system/wire-parts">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/wire-system/wire-parts/24v-battery.html"  >24v-battery</a></li>
				<li><div class="file-icon"></div><a class="" href="/gardenbot/systems/wire-system/wire-parts/24v-battery-charger.html"  >24v-battery-charger</a></li>
			</ul>
		</div>
		<button id="folder-21" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>wireviz</button>
		<div id="folder-container-21" class="dir-container requires_js " path="/gardenbot/systems/wire-system/wireviz">
			<ul class="dir-list">
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wireviz/wireviz-w1.html"  >wireviz-w1.html</a></li>
				<li><div class="file-icon non-md-file"></div><a class="" href="/gardenbot/systems/wire-system/wireviz/wireviz-w2.html"  >wireviz-w2.html</a></li>
			</ul>
		</div>
		<ul class="dir-list">
		</ul>
	</div>
	<ul class="dir-list">
	</ul>
</div>
<ul class="dir-list">
	<li><div class="file-icon"></div><a class="" href="/gardenbot/index.html"  >Home</a></li>
</ul>
</div>
    </div>
</div>
                        <div class="container">
                                
                <div style="width:100%; text-align: right;display: block;margin: 0.5rem;">
                    <div style="flex:1;display: none;"></div>
                    <div class="breadcrumbs" style="flex:1 ;padding: 0.5rem; width: fit-content;display: inline;border-radius: 0.2rem;">
                        <a href="/gardenbot/" style="color: rgb(var(--normal-text-color));">Home</a> / <span style="color: #666;">systems</span> / <span style="color: #666;">localization-sysytem</span> / <span style="color: #666;">gnss-rtk</span> / <a href="/gardenbot/systems/localization-sysytem/gnss-rtk/usb-gnss-setup.html" >usb-gnss-setup</a>
                    </div>
                </div>
<div class="content"><h1 id="usb-gnss-rtk-receiver-setup">USB GNSS RTK Receiver Setup</h1>
<div class="toc">
<ul>
<li><a href="#usb-gnss-rtk-receiver-setup" class="anchor-link">USB GNSS RTK Receiver Setup</a><ul>
<li><a href="#basic-concepts" class="anchor-link">Basic Concepts</a><ul>
<li><a href="#gnss-rtk-receiver-rover" class="anchor-link">GNSS RTK Receiver (Rover)</a></li>
<li><a href="#base-station" class="anchor-link">Base Station</a></li>
<li><a href="#continuously-operating-reference-stations-cors-network" class="anchor-link">Continuously Operating Reference Stations (CORS) network</a></li>
<li><a href="#ntrip-client" class="anchor-link">NTRIP Client</a></li>
</ul>
</li>
<li><a href="#gnss-rtk-receiver" class="anchor-link">GNSS RTK Receiver</a><ul>
<li><a href="#configure-rtk-device-correction-input-and-position-out-methods" class="anchor-link">Configure RTK device correction input and position out methods</a></li>
<li><a href="#emlid-reach" class="anchor-link">Emlid Reach</a></li>
<li><a href="#interface" class="anchor-link">Interface</a></li>
<li><a href="#identifying-serial-port" class="anchor-link">Identifying serial port</a></li>
<li><a href="#creating-a-persistent-label-for-the-rtk-gnss-usb-device" class="anchor-link">Creating a persistent label for the RTK GNSS USB device</a></li>
</ul>
</li>
<li><a href="#rtklib-str2str" class="anchor-link">RTKLIB str2str</a><ul>
<li><a href="#access-rtk-correction-service-and-rtk-correction-data" class="anchor-link">Access RTK correction service and RTK correction data</a></li>
<li><a href="#installing-rtklib" class="anchor-link">Installing RTKLIB</a></li>
<li><a href="#str2str-testing" class="anchor-link">str2str Testing</a></li>
<li><a href="#explanation-of-str2str-parameters" class="anchor-link">Explanation of str2str parameters</a></li>
</ul>
</li>
<li><a href="#environment-variables" class="anchor-link" class="anchor-link">Environment Variables</a></li>
<li><a href="#extras" class="anchor-link">Extras</a></li>
<li><a href="#ros2-demo" class="anchor-link">ROS2 Demo</a><ul>
<li><a href="#initial-testing" class="anchor-link">Initial Testing</a></li>
</ul>
</li>
<li><a href="#test-2-gpsd" class="anchor-link">Test 2 - gpsd</a><ul>
<li><a href="#test-2-results" class="anchor-link">Test 2 Results</a></li>
<li><a href="#test-2-gpsd_client" class="anchor-link">Test 2 - gpsd_client</a></li>
</ul>
</li>
<li><a href="#test-3-ros2-reach_ros_node" class="anchor-link">Test 3 - ROS2 reach_ros_node</a><ul>
<li><a href="#test-3-results" class="anchor-link">Test 3 Results</a></li>
</ul>
</li>
<li><a href="#questions" class="anchor-link">Questions</a><ul>
<li><a href="#q1-how-do-you-find-the-ntrip-mount-point-for-automatic-cells-or-single-sites" class="anchor-link">Q1. How do you find the NTRIP Mount point for Automatic Cells or Single Sites?</a></li>
</ul>
</li>
<li><a href="#nomenclature" class="anchor-link">Nomenclature</a></li>
</ul>
</li>
</ul>
</div>
<div class="callout callout-note active callout-folded inactive" rasa="1">
<div class="callout-title " onclick="toggle_callout(this.parentElement)">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Work in Progess <br />
</div>
<div class="callout-title-fold"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ChevronDown"><polyline points="6 9 12 15 18 9"></polyline>
</div>
</div>
<div class="callout-content">
<ul>
<li>Initial testing notes <a class="inline-tag" href="/gardenbot/obs.html/tags/WIP/index.html">WIP</a>   </li>
<li><a href="https://learn.sparkfun.com/tutorials/what-is-gps-rtk/all" class="external-link">https://learn.sparkfun.com/tutorials/what-is-gps-rtk/all</a>   </li>
<li><a href="https://www.ardusimple.com/rtk-explained/" class="external-link" class="external-link">https://www.ardusimple.com/rtk-explained/</a>   </li>
<li><a href="http://rtkexplorer.com/" class="external-link">rtkexplorer – Exploring low cost solutions for high precision GPS/GNSS</a>   </li>
<li><a href="https://en.wikipedia.org/wiki/NMEA_0183" class="external-link">https://en.wikipedia.org/wiki/NMEA_0183</a>   </li>
<li><a href="https://incors.in.gov/rtk.aspx" class="external-link">https://incors.in.gov/rtk.aspx</a>   </li>
<li><a href="https://wiki.openmower.de/index.php?title=System_Image#STR2STR_(optional,_recommended;_only_needed_if_you're_using_NTRIP,_so_probably_most_of_you)" class="external-link">open mower ntrip</a>   </li>
<li><a href="https://ntrip-list.com/" class="external-link">https://ntrip-list.com/</a>   </li>
<li><a href="http://reach.local" class="external-link" class="external-link">http://reach.local</a>   </li>
<li><a href="https://github.com/rtklibexplorer/RTKLIB" class="external-link" class="external-link">https://github.com/rtklibexplorer/RTKLIB</a>   </li>
<li><a href="https://packages.ubuntu.com/search?keywords=rtklib" class="external-link">https://packages.ubuntu.com/search?keywords=rtklib</a>   </li>
<li><a href="http://magnav.mit.edu/" class="external-link">http://magnav.mit.edu/</a>   </li>
<li><a href="https://youtu.be/lQuVkbphOog" class="external-link">https://youtu.be/lQuVkbphOog</a>   </li>
<li><a href="https://gssc.esa.int/wp-content/uploads/2018/07/NtripDocumentation.pdf" class="external-link">NTRIP Documenation</a>   </li>
<li><a href="https://www.unoosa.org/documents/pdf/icg/2018/ait-gnss/15a_PPP_RTKLIB.pdf" class="external-link">RTKLIB Presentation</a></li>
</ul>
</div>
</div>
<div class="callout callout-info active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
</div>
<div class="callout-title-name">Helpful Resources <br />
</div>
</div>
<div class="callout-content">
<ul>
<li><a href="https://www.ardusimple.com/rtk-explained/" class="external-link" class="external-link">RTK Explained</a>   </li>
<li><a href="https://github.com/septentrio-gnss/Septentrio_AgnosticCorrectionsProgram/blob/main/str2str/README.md#what-is-str2str" class="external-link">What is str2str</a>   </li>
<li><a href="https://gpsd.gitlab.io/gpsd/references.html" class="external-link">gpsd - Programmer's References</a>   </li>
<li><a href="https://www.ardusimple.com/product/simplertk2b-basic-starter-kit-ip65/" class="external-link">simpleRTK2B – Basic Starter Kit</a>   </li>
<li><a href="https://incors.in.gov/" class="external-link">https://incors.in.gov/</a></li>
</ul>
</div>
</div>
<p>This setup provides a tutorial on how to use a GNSS RTK Receiver, a Linux Machine, and an RTK Correction Service (or Base Station) to access position data with centimeter-level precision. Many GNSS RTK Receivers will connect to an NTRIP Caster directly utilizing its on-board LoRa,WiFi, Bluetooth, or Cellular Modem. However this tutorial is geared towards using a Linux Machine to connect to an NTRIP Caster to receive the RTK Correction Data and then relay the data to the RTK Receiver via USB. This use case is more relevant to a robotic platform that already has access to the Internet or a Local Network with an NTRIP Caster/Server. Main reason to do it this way is because your Linux Machine may already be using a Cellular Modem or Long Distance Wireless Access Point. This would render the wireless capabilities of the RTK Receiver as redundant or less capable than what the Linux machine is using.   </p>
<p><img alt="" src="/gardenbot/systems/localization-sysytem/gnss-rtk/gnss-rtk-diagram.drawio.svg" />   </p>
<h2 id="basic-concepts">Basic Concepts</h2>
<h3 id="gnss-rtk-receiver-rover">GNSS RTK Receiver (Rover)</h3>
<p>These devices have recently became available in low-cost forms with comparable performance to higher end products. It is basically a micro-controller with a GNSS antenna and receiver with the capability to run complex calculations that enable it to resolve position data with centimeter precision under the right conditions. The micro-controller may be using a library like <a href="https://github.com/rtklibexplorer/RTKLIB" class="external-link" class="external-link">RTKLIB</a> to perform the calculations. The most important condition for resolving centimeter-level precision is access to RTK corrections from a nearby (approximately 35 km) Base Station.   </p>
<h3 id="base-station">Base Station</h3>
<p>The Base Station is basically a stationary GNSS RTK Receiver that is configured to stream out RTK correction data using a NTRIP Server (COTS products offer this as a single package). A Base Station and Reference Station are synonymous.   </p>
<h3 id="continuously-operating-reference-stations-cors-network">Continuously Operating Reference Stations (CORS) network</h3>
<p>A CORS Network is a collection of GNSS Base stations combined in a single network to provide wider coverage of valid RTK correction data. Recall that RTK correction data is only valid within approximately a 35 km radius of the Base Station. A CORS network may provide convenient access to RTK correction data from the nearest base station. There also exist advance techniques to combine correction data from multiple base stations to provide correction data from a Virtual Reference Station (VRS) to further reduce location error. <a href="https://geo-matching.com/content/the-principles-and-performance-of-cors-network-rtk-and-vrs" class="external-link">See VRS for details</a>   </p>
<h3 id="ntrip-client">NTRIP Client</h3>
<p><a href="https://packages.ubuntu.com/jammy/rtklib" class="external-link">RTKLIB</a> provides a suite of CLIs and GUIs that simplify much of the work. In theory could configure your design to perform the RTK calculations on the Linux Machine. However in this tutorial, the Linux Machine is only used to relay the RTK correction data from the NTRIP Caster to the GNSS RTK Receiver. To do this we use the RTKLIB CLI <code>str2str</code> which enables us to connect to a NTRIP caster as a data input source and a GNSS RTK Receiver has a data output target. This employs our Linux machine as a NTRIP Client. Alternatively, instead of using the RTKLIB CLI, we can use the ROS package <a href="http://wiki.ros.org/ntrip_client" class="external-link">ntrip_client</a>. See OpenMower's <a href="https://github.com/ClemensElflein/open_mower_ros/blob/63f11ded7ed5eafcaaefb1778d315079e11c6fed/src/open_mower/launch/include/_ntrip_client.launch" class="external-link">ntrip_client</a> launch file for further details.   </p>
<p><a href="https://software.rtcm-ntrip.org/wiki" class="external-link">https://software.rtcm-ntrip.org/wiki</a>   </p>
<h2 id="gnss-rtk-receiver">GNSS RTK Receiver</h2>
<h3 id="configure-rtk-device-correction-input-and-position-out-methods">Configure RTK device correction input and position out methods</h3>
<p>This project is using the <a href="https://docs.emlid.com/reach/reference/specifications/reach-module-specs/" class="external-link" class="external-link">Emlid Reach RTK Module</a> and following <a href="https://docs.emlid.com/reach/" class="external-link">documentation</a>. Once the device is connected to a local WiFi network device can be accessed via the web app <a href="http://reach.local" class="external-link" class="external-link">http://reach.local</a>   </p>
<h3 id="emlid-reach">Emlid Reach</h3>
<ul>
<li>Raw data receiver: U-blox NEO-M8T – 72 channels, output rate is up to 18Hz, supports GPS L1, GLONASS G1, BeiDou B1, QZSS, SBAS, ready for Galileo E1   </li>
<li>Processing unit: Intel Edison – dual-core 500 MHz   </li>
<li>Connectivity: I2C, UART, GPIO, TimeStamp, OTG USB, Bluetooth, Wi-Fi   </li>
<li>GNSS Antenna: external with MCX connector   </li>
</ul>
<h3 id="interface">Interface</h3>
<ul>
<li>USB-to-PC    <ul>
<li>On Reach Module: Micro-USB    </li>
</ul>
</li>
<li>UART   <ul>
<li>On Reach Module: Hirose DF13-6P-1.25H(50) colloquially  "DF13 Female headers"   </li>
<li><a href="https://www.lambdrive.com/depot/Robotics/Controller/PixhawkFamily/Connector/index.html" class="external-link">https://www.lambdrive.com/depot/Robotics/Controller/PixhawkFamily/Connector/index.html</a>   </li>
<li><a href="https://store.emlid.com/us/product/reach-m-cable-for-pixhawk/" class="external-link">https://store.emlid.com/us/product/reach-m-cable-for-pixhawk/</a>   </li>
<li><a href="https://www.amazon.com/1-25mm-Adapter-Pixhawk-Controller-Quadcopter/dp/B07PWZTC88/" class="external-link">Molex PicoBlade</a>- Can be inserted into DF13 Female headers (but not visa versa)   </li>
<li><a href="https://raspberrypi.stackexchange.com/questions/104464/where-are-the-uarts-on-the-raspberry-pi-4" class="external-link">https://raspberrypi.stackexchange.com/questions/104464/where-are-the-uarts-on-the-raspberry-pi-4</a>   </li>
<li><a href="https://raspberrypi.stackexchange.com/questions/45570/how-do-i-make-serial-work-on-the-raspberry-pi3-pizerow-pi4-or-later-models/107780#107780" class="external-link">https://raspberrypi.stackexchange.com/questions/45570/how-do-i-make-serial-work-on-the-raspberry-pi3-pizerow-pi4-or-later-models/107780#107780</a>   </li>
</ul>
</li>
</ul>
<div class="callout callout-info active callout-folded inactive" rasa="1">
<div class="callout-title " onclick="toggle_callout(this.parentElement)">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
</div>
<div class="callout-title-name">The Emlid is configured with the following settings: <br />
</div>
<div class="callout-title-fold"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ChevronDown"><polyline points="6 9 12 15 18 9"></polyline>
</div>
</div>
<div class="callout-content"></div>
</div>
<p><a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a>: update the config below   </p>
<blockquote>
<p><code>[details="Simple system report"]   
app version: 28.4-r0   
enabled: true   
mode: client   
correction_input:   
  base_corrections:   
    io_type: serial   
    settings:   
      serial:   
        baud_rate: 115200   
        device: ttyGS0 (USB-to-PC)   
        send_position_to_base: true   
position_output:   
  output1:   
    io_type: serial   
    nmea_settings:   
      serial:   
        gga:   
          enabled: true   
          update_rate: 1   
        gsa:   
          enabled: false   
          update_rate: 1   
        gst:   
          enabled: false   
          update_rate: 1   
        gsv:   
          enabled: false   
          update_rate: 1   
        main_talker_id: gn   
        rmc:   
          enabled: false   
          update_rate: 1   
        vtg:   
          enabled: false   
          update_rate: 1   
        zda:   
          enabled: false   
          update_rate: 1   
    settings:   
      serial:   
        baud_rate: 9600   
        device: ttyGS0 (USB-to-PC)   
        format: NMEA   
positioning_settings:   
  elevation_mask_angle: 15   
  glonass_ar_mode: true   
  gnss_settings:   
    positioning_systems:   
      beidou: false   
      galileo: true   
      glonass: true   
      gps: true   
      qzss: true   
      sbas: true   
    update_rate: 5   
  gps_ar_mode: fix-and-hold   
  max_horizontal_acceleration: 1   
  max_vertical_acceleration: 1   
  positioning_mode: kinematic   
  snr_mask: 35   
[/details]</code>
   </p>
</blockquote>
<h3 id="identifying-serial-port">Identifying serial port</h3>
<ol>
<li>Open a terminal and enter the following command to capture the serial port device label e.g. <code>/dev/tty*</code> <a href="https://en.wikipedia.org/wiki/Serial_port#Hardware_abstraction" class="external-link">More info</a>   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>dmesg --follow
</code></pre></div>


</div>

<ol>
<li>Plugin in the USB RTK module and on the Linux terminal you should see this something like the following:    </li>
</ol>
<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code>[604400.525618] cdc_acm 1-1.3:1.0: ttyACM0: USB ACM device
                                   ^^^^^^^ make note of this label
</code></pre></div>


</div>

<div class="callout callout-note active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Note
</div>
</div>
<div class="callout-content">
<p>If you're using a terminal within a docker container you may need to try running the <br />
container in "privileged" mode. This is consider unsafe in some circumstances so you may look <a href="#TODO" class="anchor-link">here</a> for details on how to expose serial interfaces more securely.</p>
</div>
</div>
<ol>
<li>Cancel the process from step 0. In the terminal, enter the following.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo screen /dev/ttyACM0 <span class="m">9600</span>
</code></pre></div>


</div>

<p>or   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo cutecom
</code></pre></div>


</div>

<ol>
<li>You should be able to observe <a href="http://lefebure.com/articles/nmea-gga/" class="external-link" class="external-link">NMEA strings</a> streamed to the terminal. If not, your device may need to be manually configured to do so. One, alternative method is to configure the GNSS receiver to output data via TCP. Enter the either the following commands to observe the data stream.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>nc <span class="m">192</span>.168.0.20:9002
</code></pre></div>


</div>

<p>or   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>socat - TCP4:192.168.0.20:9002
</code></pre></div>


</div>

<ol>
<li>The <code>str2str</code> rtklib CLI application is use to connect to a NTRIP Caster and receive correction data.    </li>
</ol>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code>$ sudo ./str2str -in ntrip://username:password@hostname:port/mountpoint -out serial://ttyACM0:115200#52001 -b <span class="m">1</span>
</code></pre></div>


</div>

<h3 id="creating-a-persistent-label-for-the-rtk-gnss-usb-device">Creating a persistent label for the RTK GNSS USB device</h3>
<p>To use the serial device as non-root user, udev rules must be installed.   </p>
<div class="callout callout-caution active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
</div>
<div class="callout-title-name">Caution
</div>
</div>
<div class="callout-content">
<p>This serial interface label e.g. <code>ttyACM0</code> is liable to change depending on various reasons. <br />
The following commands will be used create a persistent label for serial port device and enable use by a non-root user. <br />
<br />
- <a href="http://reactivated.net/writing_udev_rules.html?#example-printer" class="external-link">http://reactivated.net/writing_udev_rules.html?#example-printer</a> <br />
- <a href="http://weng-blog.com/2017/05/udev-rule/" class="external-link">http://weng-blog.com/2017/05/udev-rule/</a> <br />
</p>
</div>
</div>
<ol>
<li>Open a terminal and enter the following follow commands.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>lsusb
</code></pre></div>


</div>

<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code>Bus 003 Device 063: ID 3032:0014 Emlid Reach
                       ^^^^ ^^^^
                    vendor  product
</code></pre></div>


</div>

<ol>
<li>On the Linux terminal you should see this something like the following:   </li>
</ol>
<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code>[604400.525618] cdc_acm 1-1.3:1.0: ttyACM0: USB ACM device
                                   ^^^^^^^ make note of this label
</code></pre></div>


</div>

<ol>
<li>Run the udev management tool <code>udevadmn</code> to capture additional info.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>udevadm info -q all -n /dev/ttyACM0
</code></pre></div>


</div>

<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code><span class="n">P</span><span class="p">:</span> <span class="o">/</span><span class="n">devices</span><span class="o">/</span><span class="n">pci0000</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">0000</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">14.0</span><span class="o">/</span><span class="n">usb3</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mf">1.2</span><span class="o">/</span><span class="n">tty</span><span class="o">/</span><span class="n">ttyACM0</span>
<span class="n">N</span><span class="p">:</span> <span class="n">ttyACM0</span>
<span class="p">....</span>
<span class="n">E</span><span class="p">:</span> <span class="n">DEVPATH</span><span class="o">=/</span><span class="n">devices</span><span class="o">/</span><span class="n">pci0000</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">0000</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">14.0</span><span class="o">/</span><span class="n">usb3</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mf">1.2</span><span class="o">/</span><span class="n">tty</span><span class="o">/</span><span class="n">ttyACM0</span>
<span class="n">E</span><span class="p">:</span> <span class="n">DEVNAME</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span>
<span class="n">E</span><span class="p">:</span> <span class="n">MAJOR</span><span class="o">=</span><span class="mi">166</span>
<span class="n">E</span><span class="p">:</span> <span class="n">MINOR</span><span class="o">=</span><span class="mi">0</span>
<span class="n">E</span><span class="p">:</span> <span class="n">SUBSYSTEM</span><span class="o">=</span><span class="n">tty</span>       <span class="o">&lt;-----------</span> <span class="n">make</span> <span class="n">note</span> <span class="n">of</span> <span class="n">this</span> <span class="n">label</span>
<span class="n">E</span><span class="p">:</span> <span class="n">USEC_INITIALIZED</span><span class="o">=</span><span class="mi">166592821213</span>
<span class="n">E</span><span class="p">:</span> <span class="n">ID_BUS</span><span class="o">=</span><span class="n">usb</span>
<span class="n">E</span><span class="p">:</span> <span class="n">ID_VENDOR_ID</span><span class="o">=</span><span class="mi">3032</span>   <span class="o">&lt;------------</span>
<span class="n">E</span><span class="p">:</span> <span class="n">ID_MODEL_ID</span><span class="o">=</span><span class="mi">0014</span>    <span class="o">&lt;------------</span>
<span class="n">E</span><span class="p">:</span> <span class="n">ID_PCI_CLASS_FROM_DATABASE</span><span class="o">=</span><span class="n">Serial</span> <span class="n">bus</span> <span class="n">controller</span>
<span class="p">....</span>
</code></pre></div>


</div>

<ol>
<li>Next we need to provide the system instructions on how to treat our GNSS USB device. Here our goal is to create a persistent name for a device node by creating a symbolic link to the default device node.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code><span class="nb">cd</span> /etc/udev/rules.d/<span class="p">;</span>
sudo vim <span class="m">51</span>-emlid.rules
</code></pre></div>


</div>

<div class="lang-shell">

<div class="codehilite"><pre><span></span><code><span class="c1"># Copy this udev with &quot;sudo cp 51-emlid.rules /etc/udev/rules.d/&quot;</span>
<span class="c1"># When done, do &quot;sudo udevadm control --reload &amp;&amp; sudo udevadm trigger&quot;</span>
<span class="c1"># Edit it to suit your type of Linux. It&#39;s currently set up for modern Ubuntu</span>
ATTRS<span class="o">{</span>idProduct<span class="o">}==</span><span class="s2">&quot;0014&quot;</span>, ATTRS<span class="o">{</span>idVendor<span class="o">}==</span><span class="s2">&quot;3032&quot;</span>, MODE:<span class="o">=</span><span class="s2">&quot;666&quot;</span>, <span class="nv">GROUP</span><span class="o">=</span><span class="s2">&quot;plugdev&quot;</span>, <span class="nv">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;tty&quot;</span>, <span class="nv">SYMLINK</span><span class="o">+=</span><span class="s2">&quot;emlid_rtk&quot;</span>
</code></pre></div>


</div>

<div class="callout callout-info active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
</div>
<div class="callout-title-name">Explanation <br />
</div>
</div>
<div class="callout-content">
<ol>
<li><strong><code>ATTRS{idProduct}=="0014", ATTRS{idVendor}=="3032":</code></strong>   </li>
<li>This helps identify a particular type or brand of device.   </li>
<li><strong><em><code>MODE:="666"</code></em></strong>   </li>
<li>"666" corresponds to read (4), write (2), and execute (1) permissions for the owner, group, and others, respectively. In this context, "666" means read and write permissions for everyone.   </li>
<li><strong><code>GROUP="plugdev":</code></strong>   </li>
<li>This specifies the group ownership of the device node. The device will be assigned to the "plugdev" group. The "plugedev" group is primarilty associated with serial commuication devices such as UART ports.   </li>
<li><strong><code>SUBSYSTEM=="tty":</code></strong>   </li>
<li>This condition narrows down the rule to devices in the "tty" (terminal) subsystem. It's often used for serial port devices.   </li>
<li><strong><code>SYMLINK+="emlid_rtk":</code></strong>   </li>
<li>This creates a symbolic link named "emlid_rtk" pointing to the device node. Symbolic links provide an additional name for the device, making it more user-friendly or predictable.</li>
</ol>
</div>
</div>
<ol>
<li>Next we must reload udev rules and then trigger udev to reevaluate devices based on those updated rules. This enables our recent changes to take effect without requiring a system restart.   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo udevadm control --reload <span class="o">&amp;&amp;</span> sudo udevadm trigger
</code></pre></div>


</div>

<p>Re-plug in USB GNSS receiver and verify <a href="http://lefebure.com/articles/nmea-gga/" class="external-link" class="external-link">NMEA strings</a> streamed to the terminal   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>ls -l /dev/emlid*
sudo screen /dev/emlid_rtk
</code></pre></div>


</div>

<h2 id="rtklib-str2str">RTKLIB str2str</h2>
<div class="callout callout-note active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Note
</div>
</div>
<div class="callout-content">
<p><a href="https://www.rtklib.com/prog/manual_2.4.2.pdf#page=101" class="external-link">RTKLIB str2str manual</a></p>
</div>
</div>
<h3 id="access-rtk-correction-service-and-rtk-correction-data">Access RTK correction service and RTK correction data</h3>
<ul>
<li>If your using a RTK correction service then we need a convenient way to store the login credentials securely. This is can be done with Environment Variables   </li>
<li>Alternatively you can set up your own base station (this requires an additional Receiver that can stream out RTK corrections).   </li>
<li>Each method will perform similarly. The limitations of each will be based on the following:   </li>
</ul>
<table>
<thead>
<tr>
<th>Method</th>
<th>Base Station Coverage</th>
<th>Cost</th>
</tr>
</thead>
<tbody>
<tr>
<td>RTK Service</td>
<td>Typically Statewide</td>
<td>Free or Subscription (depending on state)</td>
</tr>
<tr>
<td>RTK Base station</td>
<td>6 mi (single band) 36 mi (multi-band)</td>
<td>+$300 for additional receiver and antenna</td>
</tr>
</tbody>
</table>
<h3 id="installing-rtklib">Installing RTKLIB</h3>
<ol>
<li>In the terminal install the rtklib   </li>
</ol>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code>sudo apt install rtklib
</code></pre></div>


</div>

<ol>
<li>
<p>Attempt to receive RTK corrections. Note the <mark class="formatting_highlight">placeholders for the required parameters</mark> are environment variables. <a href="#environment-variables" class="anchor-link" class="anchor-link">Environment Variables</a> discusses details on how to set these up so you don't have to remember them.   </p>
</li>
<li>
<p>Single Site   </p>
</li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_SINGLE</span>/<span class="nv">$NT_ENDPOINT_SINGLE</span><span class="c1">#rtcm3</span>
</code></pre></div>


</div>

<ul>
<li>Automatic Site   </li>
</ul>
<div class="callout callout-important active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M8.5 14.5A2.5 2.5 0 0011 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 11-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 002.5 2.5z"></path></svg>
</div>
<div class="callout-title-name">Important
</div>
</div>
<div class="callout-content">
<p>Automatic site requires communication with a <strong>GNSS RTK Receiver</strong> in order to automatically send you correction data from the nearest site (mount point) or if caster is using VRS. Since there is NO target <code>-out</code> parameter provided in the example below <code>str2str</code> will timeout as it waits to receive GNSS coordinate data. In this case the <code>-in</code> <code>-out</code> semantics might be confusing since the data is being exchanged in both directions between server and client. <br />
<br />
It is important to understand that if you are using <strong>Automatic Cells or VRS</strong> (see <a href="https://incors.in.gov/InCORS%20Broadcast%20RTK%20Corrections_Products_12-05-2022_port9000.pdf" class="external-link">this</a>) then a target <code>-out</code> parameter specifying a GNSS receiver and the <code>-b 1</code> arguments must be passed with <code>str2str</code> or the NTRIP caster will time out. <br />
<br />
For additional details see <a href="#explanation-of-codeline-placeholder-0-parameters" class="anchor-link">Explanation of <code>str2str</code> parameters</a></p>
</div>
</div>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_AUTO</span>/<span class="nv">$NT_ENDPOINT_AUTO</span>
</code></pre></div>


</div>

<h3 id="str2str-testing"><code>str2str</code> Testing</h3>
<ol>
<li>Run the <code>str2str</code> rtklib CLI application   </li>
</ol>
<p>To receive <strong>Single site</strong> corrections via NTRIP and relay to USB GNSS receiver via serial   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_SINGLE</span>/<span class="nv">$NT_ENDPOINT_SINGLE</span><span class="c1">#rtcm3 -out serial://emlid_rtk:115200#52001</span>
</code></pre></div>


</div>

<p>To Receive <strong>Automatic cell</strong> corrections via NTRIP and relay to USB GNSS receiver via serial    </p>
<div class="callout callout-important active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M8.5 14.5A2.5 2.5 0 0011 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 11-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 002.5 2.5z"></path></svg>
</div>
<div class="callout-title-name">Important
</div>
</div>
<div class="callout-content">
<p>For VRS or Automatic Cell sites, just be sure to include <code>-b 1</code> with your output stream.</p>
</div>
</div>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_AUTO</span>/<span class="nv">$NT_ENDPOINT_AUTO</span> -out serial://emlid_rtk:115200 -b <span class="m">1</span>
</code></pre></div>


</div>

<div class="callout callout-note active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Note
</div>
</div>
<div class="callout-content">
<p>STR2STR also implements "Output Received Stream to TCP Port" option like STRSVR 2.4.3 b34 <br />
<a href="https://github.com/tomojitakasu/RTKLIB/issues/573#issuecomment-760017844" class="external-link">https://github.com/tomojitakasu/RTKLIB/issues/573#issuecomment-760017844</a></p>
</div>
</div>
<ul>
<li>Alt. to Receive <strong>Automatic cell</strong> corrections via NTRIP and stream RTCM sentences via serial port. Stream reciever NMEA sentences via serial and TCP port 52001.   </li>
</ul>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_AUTO</span>/<span class="nv">$NT_ENDPOINT_AUTO</span> -out serial://emlid_rtk:115200#52001 -b <span class="m">1</span>
</code></pre></div>


</div>

<ol>
<li>Listen   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>nc localhost <span class="m">52001</span>
</code></pre></div>


</div>

<h3 id="explanation-of-str2str-parameters">Explanation of <code>str2str</code> parameters</h3>
<p><a href="https://github.com/septentrio-gnss/Septentrio_AgnosticCorrectionsProgram/blob/main/str2str/README.md#running-str2str" class="external-link">Running str2str</a>   </p>
<p><a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a>   </p>
<ul>
<li>-in ntrip://<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/FFB8EBA6/index.html">FFB8EBA6</a>;">username</mark>:<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/FFB86CA6/index.html">FFB86CA6</a>;">password</mark>@<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/BBFABBA6/index.html">BBFABBA6</a>;">host</mark>:<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/ADCCFFA6/index.html">ADCCFFA6</a>;">port</mark>/<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/CACFD9A6/index.html">CACFD9A6</a>;">mount</mark>#<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/FF5582A6/index.html">FF5582A6</a>;">format</mark>   <ul>
<li>username:    </li>
<li>password:   </li>
<li>host   </li>
<li>port:   </li>
<li>mount:   </li>
<li>format:   </li>
</ul>
</li>
<li>-out serial://<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/FFF3A3A6/index.html">FFF3A3A6</a>;">device_port</mark>:<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/ABF7F7A6/index.html">ABF7F7A6</a>;">bitrate</mark>:<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/D2B3FFA6/index.html">D2B3FFA6</a>;">parity</mark>:<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/FFB8EBA6/index.html">FFB8EBA6</a>;">stopbit</mark>:<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/FFB86CA6/index.html">FFB86CA6</a>;">fctr</mark>#<mark style="background: <a class="inline-tag" href="/gardenbot/obs.html/tags/BBFABBA6/index.html">BBFABBA6</a>;">output_tcp_port</mark>   <ul>
<li>device_port:    </li>
<li>bitrate:    </li>
<li>parity:    </li>
<li>stopbit:    </li>
<li>fctr:    </li>
<li>output_tcp_port:   </li>
</ul>
</li>
<li>-b 1: The <code>-b 1</code> indicates we want to use the <strong>1st</strong> of many output streams (if multiple outputs streams are used) as the source to send NMEA GGA messages to the corrections provider (required for VRS or Automatic Cells)   </li>
</ul>
<p>background   </p>
<h2 id="environment-variables">Environment Variables</h2>
<p>There are multiple ways to do this. The most important point is to choose the way that offers the least risk from developers accidentally committing passwords or secrets to your public git repo.   </p>
<p><a href="https://www.linode.com/docs/guides/how-to-set-linux-environment-variables/" class="external-link">https://www.linode.com/docs/guides/how-to-set-linux-environment-variables/</a>   </p>
<ol>
<li>Open new terminal,  and append the <code>.bashrc</code> file with the following template and overwriting the characters with <code>...</code>    </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>sudo vim ~/.bashrc
</code></pre></div>


</div>

<div class="callout callout-warning active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
</div>
<div class="callout-title-name">Warning
</div>
</div>
<div class="callout-content">
<p>Note login credentials environment variables have been omitted. Use this snippet as a template. Be careful <strong>NOT</strong> to upload theses to the internet. This should pasted at the bottom of the .bashrc file of the Linux machine. This will create permanent environment variables to store RTK correction service login credentials. This template has two separate ports and endpoints for connecting to a network that automatically selects a reference station and one for connecting a specific reference station.</p>
</div>
</div>
<div class="callout callout-info active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
</div>
<div class="callout-title-name">Info
</div>
</div>
<div class="callout-content">
<p>If you prefer not to store secrets as environment variables <a href="https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html#32-where-should-a-secret-be" class="external-link">OWSAP recommends</a> using secrets-manager such as:   </p>
<blockquote>
<p><a href="https://aws.amazon.com/secrets-manager/" class="external-link">AWS Secret Manager</a>, <a href="https://azure.microsoft.com/nl-nl/services/key-vault/" class="external-link">Azure Key Vault</a>, <a href="https://cloud.google.com/secret-manager" class="external-link">Google Secret Manager</a>), or other third-party facilities (<a href="https://www.vaultproject.io/" class="external-link">Hashicorp Vault</a>, <a href="https://www.conjur.org/" class="external-link">Conjur</a>, <a href="https://www.keepersecurity.com/" class="external-link">Keeper</a>, <a href="https://lyft.github.io/confidant/" class="external-link">Confidant</a>) <br />
<br />
Other secret managers are: <br />
- <a href="https://bitwarden.com/products/secrets-manager/" class="external-link">bitwarden</a> <br />
- <a href="https://infisical.com/infisical-vs-hashicorp-vault" class="external-link">infisical</a> <br />
- <a href="https://github.com/getsops/sops" class="external-link">https://github.com/getsops/sops</a> <br />
- ⭐<a href="https://dotenvx.com/" class="external-link">https://dotenvx.com/</a></p>
</blockquote>
</div>
</div>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code><span class="c1"># InCORS RTK correction service credentials https://incors.in.gov/</span>
<span class="c1">#########################################################</span>
<span class="c1"># DO NOT commit to source control unless encrypted      #</span>
<span class="c1">#########################################################</span>
<span class="nb">export</span> <span class="nv">NT_HOSTNAME</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
<span class="c1"># Automatic cells</span>
<span class="nb">export</span> <span class="nv">NT_PORT_AUTO</span><span class="o">=</span><span class="s1">&#39;9000&#39;</span>
<span class="nb">export</span> <span class="nv">NT_ENDPOINT_AUTO</span><span class="o">=</span><span class="s1">&#39;RTCM3_MAX&#39;</span>
<span class="c1"># single site</span>
<span class="nb">export</span> <span class="nv">NT_PORT_SINGLE</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
<span class="nb">export</span> <span class="nv">NT_ENDPOINT_SINGLE</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
<span class="c1"># secret</span>
<span class="nb">export</span> <span class="nv">NT_USER</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
<span class="nb">export</span> <span class="nv">NT_PASSWORD</span><span class="o">=</span><span class="s1">&#39;...&#39;</span>
</code></pre></div>


</div>

<ol>
<li>After saving edits, close the terminal then run <code>source ~/.bahsrc</code>   </li>
<li>Verify environment variables   </li>
</ol>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code><span class="nb">echo</span> -e <span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip hostname:        &#39;</span> <span class="nv">$NT_HOSTNAME</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip port_auto:       &#39;</span> <span class="nv">$NT_PORT_AUTO</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip endpoint_auto:   &#39;</span> <span class="nv">$NT_ENDPOINT_AUTO</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip port_sigle:      &#39;</span> <span class="nv">$NT_PORT_SINGLE</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip endpoint_single: &#39;</span> <span class="nv">$NT_ENDPOINT_SINGLE</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;ntrip user:            &#39;</span> <span class="nv">$NT_USER</span><span class="s1">&#39;\n&#39;</span><span class="se">\</span>
<span class="s1">&#39;nitrip password:       &#39;</span> <span class="nv">$NT_PASSWORD</span>
</code></pre></div>


</div>

<div class="callout callout-note active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Note
</div>
</div>
<div class="callout-content">
<p>Alternatively, you can save the environment variables to a standalone file such as <code>.env.dev</code> and then encrypt the value of the key-value pair with <a href="https://dotenvx.com/encryption" class="external-link">dontenvx</a>. Just don't commit your <code>.env.keys</code> 😉 <br />
<br />
The main risk is are the following: <br />
1. You main accidentally commit <code>.env.dev</code> file decrypted. <br />
2. You may accidentally commit the <code>.env.keys</code> file. <br />
3. Not <a href="https://en.wikipedia.org/wiki/Shor's_algorithm#Feasibility_and_impact" class="external-link">post-quantum safe</a>.</p>
</div>
</div>
<hr />
<h2 id="extras">Extras</h2>
<ul>
<li>Set trace level with <code>-t 3</code> and you can read logs with <code>cat str2str.trace</code>   </li>
</ul>
<div class="lang-sh">

<div class="codehilite"><pre><span></span><code>str2str -in ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_SINGLE</span>/<span class="nv">$NT_ENDPOINT_SINGLE</span><span class="c1">#rtcm3 -t 3</span>
</code></pre></div>


</div>

<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>cat str2str.trace
</code></pre></div>


</div>

<h2 id="ros2-demo">ROS2 Demo</h2>
<h3 id="initial-testing">Initial Testing</h3>
<ul>
<li>Configure the Emlid Reach device "Correction input" settings to connect to an NTRIP server via the webapp. Note this ideally should be done via <code>str2str</code> because such method would used the rpi's network connection instead of the WiFi module on-board the Reach device itself. The main hurdle with using <code>str2str</code> is that the command typically connects to the serial interface of the GPS device and most ROS2 packages will only connect to a GPS devices' serial interface. This is <em>OK</em> because we could provide a second serial interface via the UART interface on-board the Reach device and connect the GPIO/UART pins on to the rpi. However this demo section is simply exploring the several ways of getting RTK correction data to our GPS device and then connecting the NEMA sentences to a ROS2 node that can then publish <code>NavSatFix</code> messages.   </li>
<li><img alt="" src="/gardenbot/systems/localization-sysytem/gnss-rtk/reach-correction-input.png" />   </li>
<li>Install the <code>nmea_serial_driver</code> ROS2 package   </li>
</ul>
<div class="lang-sh">

<div class="codehilite"><pre><span></span><code>sudo apt update
sudo apt install ros-humble-nmea-navsat-driver
</code></pre></div>


</div>

<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>ros2 run nmea_navsat_driver nmea_serial_driver --ros-args --params-file ./config/nmea_serial_driver.yaml
</code></pre></div>


</div>

<ul>
<li>Echo the ROS2 topic <code>/fix</code> which contains the <code>sensor_msgs/msg/NavSatFix</code>  messages   </li>
</ul>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>ros2 topic info /fix
</code></pre></div>


</div>

<ul>
<li>Observe the <code>NavSatFix</code> messages with covariance data.    </li>
</ul>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>header:
  stamp:
    sec: <span class="m">1705213614</span>
    nanosec: <span class="m">891449711</span>
  frame_id: gps
status:
  status: <span class="m">2</span>
  service: <span class="m">1</span>
latitude: omitted
longitude: omitted
altitude: omitted
position_covariance:
- <span class="m">0</span>.000144
- <span class="m">0</span>.0
- <span class="m">0</span>.0
- <span class="m">0</span>.0
- <span class="m">0</span>.000144
- <span class="m">0</span>.0
- <span class="m">0</span>.0
- <span class="m">0</span>.0
- <span class="m">0</span>.0144
position_covariance_type: <span class="m">1</span>
</code></pre></div>


</div>

<ul>
<li><strong>Takeaway</strong>: This initial test verifies the principles, but one draw back is that the RTCM messages are streamed to the Reach module via it's onboard WiFi connection from the local network. Ideally I would prefer the RTCM messages were streamed to the Reach Module via the Raspberry Pis' in a "PC-to-USB" fashion. The main hurdle with this is we will need to use the UART ports on the the Reach module and Raspberry Pi to receive NMEA sentences. Using a single serial port for transmitting correction data to GNSS receiver and reading the NMEA sentences  (using two separate processes) <strong>doesn't seem possible or is error prone</strong> at this time so two serial port may be necessary.    </li>
</ul>
<p>My current understanding of possible configurations at this moment are: <br />
1. Utilize Reach Modules' on-board WiFi and NTRIP client software to receive RTCM and stream the receiver "Position Output" to the Raspberry Pi in a "Serial-To-PC" fashion and utilize <code>nmea_navsat_diver</code> (Initial Testing Config) <br />
2. Utilize <code>str2str</code> and <code>nmea_navsat_driver</code> and <strong>UART</strong> as a second channel for receiving NMEA sentences while <strong>PC-to-Serial</strong> is used for streaming RTCM Messages to the Reach Module. <br />
3. Utilize <code>str2str</code> and <span class="formatting_strikethrough"><code>nmea_tcp_driver</code> (Only after <a href="https://github.com/CearLab/nmea_tcp_driver" class="external-link">nmea_tcp_driver</a> is rewritten for ROS2 support 💀) Currently started on a <a href="https://github.com/digitalhabitat/emlid_reach_ros2" class="external-link">emlid_reach_ros2</a> but I'm not sure how much work is required.</span> <br />
4. Utilize <code>str2str</code> and <a href="https://index.ros.org/p/gpsd_client/#humble" class="external-link" class="external-link">gpsd_client</a>   </p>
<h2 id="test-2-gpsd">Test 2 - gpsd</h2>
<p>Connect emlid device with correction service via <a href="https://manpages.ubuntu.com/manpages/jammy/en/man1/str2str.1.html" class="external-link" class="external-link">str2str</a> and Output Received Stream to TCP Port 52001.   </p>
<div class="lang-sh">

<div class="codehilite"><pre><span></span><code>str2str -in ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_SINGLE</span>/<span class="nv">$NT_ENDPOINT_SINGLE</span><span class="c1">#rtcm3 -out serial://emlid_rtk:115200#52001</span>
</code></pre></div>


</div>

<p>Verify NMEA stream is present on port 52001 with <a href="https://man.archlinux.org/man/nc.1" class="external-link">nc</a>.   </p>
<div class="lang-sh">

<div class="codehilite"><pre><span></span><code>nc localhost <span class="m">52001</span>
</code></pre></div>


</div>

<p>Launch <a href="https://man.archlinux.org/man/gpsd.8" class="external-link">gpsd</a> with the following options. This program parses the NMEA stream on the TCP port.   </p>
<ul>
<li><code>-N</code>: don't go into background   </li>
<li><code>-p</code>: do not reconfigure the receiver automatically   </li>
<li><code>-d</code>: set debug level, default 0    </li>
<li><code>-S</code>: set port for daemon, default 2947   </li>
<li><code>tcp://host[:port]</code>   </li>
</ul>
<div class="lang-sh">

<div class="codehilite"><pre><span></span><code> sudo gpsd -N -p -D <span class="m">5</span> -S <span class="m">10002</span> tcp://localhost:52001
</code></pre></div>


</div>

<p>Run <a href="https://man.archlinux.org/man/cgps.1.en" class="external-link">cgps</a> to verify that <code>gpsd</code> can relay the GPS data.    </p>
<div class="lang-sh">

<div class="codehilite"><pre><span></span><code>cgps localhost:10002
</code></pre></div>


</div>

<p>or   </p>
<div class="lang-sh">

<div class="codehilite"><pre><span></span><code>gpsmon localhost:10002
</code></pre></div>


</div>

<p>Output from <code>cgps</code>. Notice we have a fix status.   </p>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code><span class="err">┌───────────────────────────────────────────┐┌──────────────────</span><span class="n">Seen</span><span class="w">  </span><span class="mi">0</span><span class="o">/</span><span class="n">Used</span><span class="w">  </span><span class="mi">0</span><span class="err">┐</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Time</span><span class="p">:</span><span class="w">          </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w">                    </span><span class="err">││</span><span class="n">GNSS</span><span class="w">   </span><span class="n">PRN</span><span class="w">  </span><span class="n">Elev</span><span class="w">   </span><span class="n">Azim</span><span class="w">   </span><span class="n">SNR</span><span class="w"> </span><span class="n">Use</span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Latitude</span><span class="p">:</span><span class="w">         </span><span class="o">&lt;</span><span class="n">omitted</span><span class="o">&gt;</span><span class="w">   </span><span class="n">N</span><span class="w">           </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Longitude</span><span class="p">:</span><span class="w">        </span><span class="o">&lt;</span><span class="n">omitted</span><span class="o">&gt;</span><span class="w">   </span><span class="n">W</span><span class="w">           </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Alt</span><span class="w"> </span><span class="p">(</span><span class="n">HAE</span><span class="p">,</span><span class="w"> </span><span class="n">MSL</span><span class="p">):</span><span class="w">   </span><span class="o">&lt;</span><span class="n">omitted</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">omitted</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Speed</span><span class="p">:</span><span class="w">           </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                      </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Track</span><span class="w"> </span><span class="p">(</span><span class="bp">true</span><span class="p">,</span><span class="w"> </span><span class="k">var</span><span class="p">):</span><span class="w">                </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="n">deg</span><span class="w"> </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Climb</span><span class="p">:</span><span class="w">           </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">                      </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Status</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="n">D</span><span class="w"> </span><span class="n">RTK</span><span class="w"> </span><span class="n">FIX</span><span class="w"> </span><span class="p">(</span><span class="mi">161</span><span class="w"> </span><span class="n">secs</span><span class="p">)</span><span class="w">     </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">Err</span><span class="w">  </span><span class="p">(</span><span class="n">XDOP</span><span class="p">,</span><span class="w"> </span><span class="n">EPX</span><span class="p">):</span><span class="w">  </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">        </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Lat</span><span class="w"> </span><span class="n">Err</span><span class="w">   </span><span class="p">(</span><span class="n">YDOP</span><span class="p">,</span><span class="w"> </span><span class="n">EPY</span><span class="p">):</span><span class="w">  </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">        </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Alt</span><span class="w"> </span><span class="n">Err</span><span class="w">   </span><span class="p">(</span><span class="n">VDOP</span><span class="p">,</span><span class="w"> </span><span class="n">EPV</span><span class="p">):</span><span class="w">  </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">+/-</span><span class="w">  </span><span class="mi">150</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="n">D</span><span class="w"> </span><span class="n">Err</span><span class="w">    </span><span class="p">(</span><span class="n">HDOP</span><span class="p">,</span><span class="w"> </span><span class="n">CEP</span><span class="p">):</span><span class="w">  </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">+/-</span><span class="w"> </span><span class="mf">81.0</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="n">D</span><span class="w"> </span><span class="n">Err</span><span class="w">    </span><span class="p">(</span><span class="n">PDOP</span><span class="p">,</span><span class="w"> </span><span class="n">SEP</span><span class="p">):</span><span class="w">  </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">+/-</span><span class="w">  </span><span class="mi">149</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">Err</span><span class="w">  </span><span class="p">(</span><span class="n">TDOP</span><span class="p">):</span><span class="w">       </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">               </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Geo</span><span class="w"> </span><span class="n">Err</span><span class="w">   </span><span class="p">(</span><span class="n">GDOP</span><span class="p">):</span><span class="w">       </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">               </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">ECEF</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">VX</span><span class="p">:</span><span class="w">              </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">    </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">       </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">ECEF</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">VY</span><span class="p">:</span><span class="w">              </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">    </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">       </span><span class="err">││</span><span class="w">                                 </span>
<span class="err">│</span><span class="w"> </span><span class="n">ECEF</span><span class="w"> </span><span class="n">Z</span><span class="p">,</span><span class="w"> </span><span class="n">VZ</span><span class="p">:</span><span class="w">              </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">    </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">       </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Speed</span><span class="w"> </span><span class="n">Err</span><span class="w"> </span><span class="p">(</span><span class="n">EPS</span><span class="p">):</span><span class="w">        </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">               </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Track</span><span class="w"> </span><span class="n">Err</span><span class="w"> </span><span class="p">(</span><span class="n">EPD</span><span class="p">):</span><span class="w">        </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">               </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">offset</span><span class="p">:</span><span class="w">            </span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="w">               </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">│</span><span class="w"> </span><span class="n">Grid</span><span class="w"> </span><span class="n">Square</span><span class="p">:</span><span class="w">            </span><span class="o">&lt;</span><span class="n">omitted</span><span class="o">&gt;</span><span class="w">         </span><span class="err">││</span><span class="w">                                 </span><span class="err">│</span><span class="w"></span>
<span class="err">└───────────────────────────────────────────┘└─────────────────────────────────┘</span><span class="w"></span>
</code></pre></div>


</div>

<h3 id="test-2-results">Test 2 Results</h3>
<p>We demonstrated that a single connection (USB) to the emlid GPS device running the programs <code>str2str</code> and <code>gpsd</code> on the <a href="/gardenbot/not_created.html" class="nonexistent-link">rpi</a> prepare us to utilize the ROS2 package <a href="https://index.ros.org/p/gpsd_client/#humble" class="external-link" class="external-link">gpsd_client</a>to offer <code>NavSatFix</code> messages.   </p>
<h3 id="test-2-gpsd_client">Test 2 - <code>gpsd_client</code></h3>
<div class="callout callout-note active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Note
</div>
</div>
<div class="callout-content">
<p>These commands quickly become cumbersome to wrangle with. A more practical solution will use a single command that essentially calls the following commands sequentially. These commands are provided as an educational guide and demonstrate principles. Here is a ROS2 python launch file that streamlines the process. <a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a> link here</p>
</div>
</div>
<p>Connect emlid device with correction service via <a href="https://manpages.ubuntu.com/manpages/jammy/en/man1/str2str.1.html" class="external-link" class="external-link">str2str</a> and Output Received Stream to TCP Port 9123.   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>str2str -in ntrip://<span class="nv">$NT_USER</span>:<span class="nv">$NT_PASSWORD</span>@<span class="nv">$NT_HOSTNAME</span>:<span class="nv">$NT_PORT_AUTO</span>/<span class="nv">$NT_ENDPOINT_AUTO</span> -out serial://emlid_rtk:115200#9123 -b <span class="m">1</span>
</code></pre></div>


</div>

<p>Start the gspd server in the foreground (<code>-N</code>) on port 9234 (<code>-S</code>) and connect to the previously instantiated TCP stream on port 9123 (<code>tcp://localhost:9123</code>).   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>gpsd -N -S <span class="m">9234</span> tcp://localhost:9123
</code></pre></div>


</div>

<p>Start the <code>gpsd_client</code> ROS2 node and connect client to the previously started <code>gpsd</code> server   </p>
<div class="callout callout-important active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M8.5 14.5A2.5 2.5 0 0011 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 11-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 002.5 2.5z"></path></svg>
</div>
<div class="callout-title-name">Important
</div>
</div>
<div class="callout-content">
<p>No nodes (executables) are compiled for <code>gpsd_client</code>. You'll have to load it as a <a href="https://docs.ros.org/en/foxy/Concepts/About-Composition.html#using-components" class="external-link">component</a>, <code>gpsd_client::GPSDClientComponent</code>. And the <code>ros2 component standalone</code> command doesn't support <code>--ros-args</code> directly. Instead, you must use the <code>ros2 component load</code> command in conjunction with <code>ros2 run</code> to achieve a similar effect.</p>
</div>
</div>
<p>Start the component container.   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>ros2 run rclcpp_components component_container
</code></pre></div>


</div>

<p>In a new terminal, load the component into the container with the specified parameters.   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>ros2 component load /ComponentManager gpsd_client gpsd_client::GPSDClientComponent --node-name gpsd_client_composed_node --param host:<span class="o">=</span>localhost --param port:<span class="o">=</span><span class="m">9234</span> --param use_gps_time:<span class="o">=</span><span class="nb">false</span> --param check_fix_by_variance:<span class="o">=</span><span class="nb">false</span> --param frame_id:<span class="o">=</span>gps --param publish_rate:<span class="o">=</span><span class="m">1</span>
</code></pre></div>


</div>

<p>Print the ROS <code>sensor_msgs/msg/NavSatFix</code> topic to the terminal.   </p>
<div class="lang-shell">

<div class="codehilite"><pre><span></span><code>ros2 <span class="nb">echo</span> /fix
</code></pre></div>


</div>

<p>Observe, GNSS data with a valid fix is available in our ROS topic 🥳   </p>
<div class="lang-stdout">

<div class="codehilite"><pre><span></span><code><span class="n">header</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="n">stamp</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">sec</span><span class="o">:</span><span class="w"> </span><span class="mi">1721540846</span><span class="w"></span>
<span class="w">    </span><span class="n">nanosec</span><span class="o">:</span><span class="w"> </span><span class="mi">346349874</span><span class="w"></span>
<span class="w">  </span><span class="n">frame_id</span><span class="o">:</span><span class="w"> </span><span class="n">gps</span><span class="w"></span>
<span class="k">status</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="k">status</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;---</span><span class="w"> </span><span class="n n-Quoted">`STATUS_FIX`</span><span class="p">,</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">fix</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">obtained</span><span class="p">.</span><span class="w"></span>
<span class="w">  </span><span class="n">service</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">latitude</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">omitted</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">longitude</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">omitted</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">altitude</span><span class="o">:</span><span class="w">  </span><span class="o">&lt;</span><span class="n">omitted</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">position_covariance</span><span class="o">:</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">10.632</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">24.189</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<span class="o">-</span><span class="w"> </span><span class="mf">42.55</span><span class="w"></span>
<span class="n">position_covariance_type</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
</code></pre></div>


</div>

<h2 id="test-3-ros2-reach_ros_node">Test 3 - ROS2 reach_ros_node</h2>
<p>Pretesting Note: Recently a ROS1 package (<a href="https://github.com/rpng/reach_ros_node/tree/ros2" class="external-link">reach_ros_node</a>) became available for ROS2 for the <a href="https://docs.emlid.com/reach/reference/specifications/reach-module-specs/" class="external-link" class="external-link">Emlid Reach RTK Module</a>. If this works the way I expect it, I would only need to run the <code>str2str</code> command with the TCP output and the node from this package.   </p>
<h3 id="test-3-results">Test 3 Results</h3>
<p>I encountered issues with the ros2 branch of reach_ros_node. It seems that it is not fully developed for ROS2 yet.   </p>
<h2 id="questions">Questions</h2>
<h3 id="q1-how-do-you-find-the-ntrip-mount-point-for-automatic-cells-or-single-sites">Q1. How do you find the NTRIP Mount point for Automatic Cells or Single Sites?</h3>
<ol>
<li>The service provider may have a number of resources such as a table specifying the connection details or an interactive map of Sites a part of the CORs Network.   </li>
<li>With a given <strong>IP address</strong> and <strong>Port</strong> you can use <code>str2str -in ntrip://&lt;ip&gt;:&lt;port&gt;</code> to return a <strong>Source Table</strong> with the 2nd data field specifying the mount point. <a href="https://software.rtcm-ntrip.org/wiki/STR" class="external-link">For more info see</a>   </li>
<li>There are also several tools that enable you browse the available mount points on such as <a href="http://monitor.use-snip.com/" class="external-link">http://monitor.use-snip.com/</a>  or <a href="https://www.rtklib.com/prog/manual_2.4.2.pdf#page=85" class="external-link">srctblbrows.exe</a>   </li>
</ol>
<h2 id="nomenclature">Nomenclature</h2>
<p><a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a>   </p>
<p>Source Table: Represents contents list of provided data by NTRIP servers   </p>
<ol>
<li>
<p><strong>RTK (Real-Time Kinematic):</strong> A technique used to improve the precision of GNSS data.   </p>
</li>
<li>
<p><strong>GNSS (Global Navigation Satellite System):</strong> A generic term used for satellite navigation systems including GPS, GLONASS, Galileo, and BeiDou.   </p>
</li>
<li>
<p><strong>PPP (Precise Point Positioning):</strong>   </p>
</li>
<li>
<p><strong>Base Station:</strong> A stationary GNSS receiver used as a reference point for RTK corrections.   </p>
</li>
<li>
<p><strong>Rover Station:</strong> A mobile GNSS receiver that receives corrections from a base station.   </p>
</li>
<li>
<p><strong>NMEA message/string</strong>: <a class="inline-tag" href="/gardenbot/obs.html/tags/todo/index.html">todo</a>   </p>
</li>
<li>
<p><strong>NTRIP (Networked Transport of RTCM via Internet Protocol):</strong> A communication protocol to streaming RTCM correction data over the internet.   </p>
</li>
<li>
<p><strong>RTCM (Radio Technical Commission for Maritime Services):</strong>  An international standards body that defines standards such as, RTCM SC-104, which specifies a set of binary messages (aka RTCM messages) containing GNSS correction data.   </p>
</li>
<li>
<p><strong>Observation Data:</strong> Raw GNSS measurements collected by a receiver, including pseudoranges and carrier phase information.   </p>
</li>
<li>
<p><strong>Solution:</strong> The final output of the positioning process, providing accurate coordinates for a specific location.   </p>
</li>
<li>
<p><strong>Float Solution:</strong> A position solution with a lower level of accuracy, often used in standard GPS positioning.   </p>
</li>
<li>
<p><strong>Fix Solution:</strong> A high-precision position solution achieved through RTK techniques, providing centimeter-level accuracy.   </p>
</li>
<li>
<p><strong>DGNSS (Differential GNSS):</strong> A technique that improves GNSS accuracy by using correction data from a reference station.   </p>
</li>
<li>
<p><strong>Cycle Slip:</strong>    </p>
</li>
<li>
<p><strong>ION (Institute of Navigation):</strong> A professional organization that focuses on the science and art of navigation.   </p>
</li>
<li>
<p><strong>Tropospheric Delay:</strong> The slowing of GNSS signals as they pass through the Earth's atmosphere, affecting accuracy.   </p>
</li>
<li>
<p><strong>Receiver Firmware:</strong> . Embedded software of GNSS receievers.   </p>
</li>
<li>
<p><strong>RINEX (Receiver Independent Exchange Format):</strong> A standard format for exchanging GNSS data between different software.   </p>
</li>
<li>
<p><strong>Solution Status:</strong> Information indicating the quality and reliability of the position solution, such as 'FIXED' or 'FLOAT.'   </p>
</li>
<li>
<p><strong>Ambiguity Resolution:</strong> The process of determining the integer values in carrier phase measurements to improve positioning accuracy in RTK.</p>
</li>
</ol></div>
<div class="note-footer">
<div class="backlinks">
<h2>Backlinks</h2>
<ul>
	<li><a class="backlink" href="/gardenbot/systems/localization-sysytem/localization-system.html">localization-system</a></li>
</ul>
</div>

<div class="tags">
<h2>Tags</h2>
<ul>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/WIP/index.html">WIP</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/FF5582A6/index.html">FF5582A6</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/FFB86CA6/index.html">FFB86CA6</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/ADCCFFA6/index.html">ADCCFFA6</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/CACFD9A6/index.html">CACFD9A6</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/BBFABBA6/index.html">BBFABBA6</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/todo/index.html">todo</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/D2B3FFA6/index.html">D2B3FFA6</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/FFB8EBA6/index.html">FFB8EBA6</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/ABF7F7A6/index.html">ABF7F7A6</a></li>
	<li><a class="backlink" href="/gardenbot/obs.html/tags/FFF3A3A6/index.html">FFF3A3A6</a></li>
</ul>
</div>

</div>
<div class="graph requires_js ">
    <div id="A237002525922344656290598051499699256987{level}" class="graph_div"></div>

    <div class="graph-instructions" id="D237002525922344656290598051499699256987{level}">
        Left-click: follow link, Right-click: select node, Scroll: zoom
    </div>
    
    <div class="graph-button-row" style="display:flex;">
        <button class="graph_button graph_show_button" id="B237002525922344656290598051499699256987{level}" level="{level}" note_temp_id="237002525922344656290598051499699256987" onclick="window.ObsHtmlGraph.run(this, '237002525922344656290598051499699256987', 'usb-gnss-setup');">
            Show Graph
        </button>
        <button class="graph_button graph_type_button" id="C237002525922344656290598051499699256987{level}" style="flex:1" onclick="window.ObsHtmlGraph.switch_graph_type(this);">
            2D
        </button>
    </div>
</div>

<script type="module">
    if (window.ObsHtmlGraph == undefined){
        import('/gardenbot/obs.html/static/graph.js').then((Module) => {
            window.ObsHtmlGraph = Module;
            window.ObsHtmlGraph.arm_page(document.getElementById('page_holder'))
        })
    }
</script>




                                <!-- end content -->
                        </div>
                        <div class="container_filler">
                        </div>
                        <div id="right_pane" class="right_pane active">
    <div id="right_pane_fold_header" class="right_pane_fold_header fold_header">x</div>
    <div id="right_pane_content" class="right_pane_content">
            
    </div>
</div>
                </div>
        </div>

        <script>
                function handle_toggle_side_bar(e){
                        let header;
                        let pane; 
                        let target = e.target

                        // switch out the navbar button click for a header click
                        if (target.id == 'left_pane_toggle_nav'){
                                target = document.getElementById('left_pane_fold_header')
                        }
                        else if (target.id == 'right_pane_toggle_nav'){
                                target = document.getElementById('right_pane_fold_header')
                        }

                        // get header and pane
                        if (target.classList.contains('fold_header')) {
                                header = target;
                                pane = target.parentElement;
                        }
                        else {
                                pane = target;
                                header = target.getElementsByClassName('fold_header')[0];
                        }
                        toggle_side_bar(pane, header, true)
                        e.stopPropagation();
                }
                function handle_toggle_side_bar_button(e){
                        document.getElementById('menu_toggle_button').click()
                        handle_toggle_side_bar(e);
                }

                function toggle_side_bar(pane, header, save) {
                        let active = (pane.classList.contains('active'))
                        if (active){
                                disable_side_bar(pane, header, save);
                        }
                        else {
                                enable_side_bar(pane, header, save);
                        }
                }
                function enable_side_bar(pane, header, save){
                        pane.classList.add('active');
                        pane.removeEventListener('click', handle_toggle_side_bar);
                        header.addEventListener('click', handle_toggle_side_bar);
                        set_correct_header_symbol(header);
                        if (save){ save_panel_folding_state(header, true) }
                }
                function disable_side_bar(pane, header, save){
                        pane.classList.remove('active');
                        pane.addEventListener('click', handle_toggle_side_bar);
                        header.removeEventListener('click', handle_toggle_side_bar);
                        set_correct_header_symbol(header);
                        if (save){ save_panel_folding_state(header, false) }
                }
                function set_correct_header_symbol(header){
                        let pane = header.parentElement;
                        let symbol = [['>', '<'],['<', '>']]
                        symbol = symbol[Number(header.classList.contains('right_pane_fold_header'))][Number(pane.classList.contains('active'))];
                        console.log(symbol);
                        header.innerHTML = symbol
                        return header;
                }
                function panel_folding_get_panel_name(header){
                        return ['left', 'right'][Number(header.classList.contains('right_pane_fold_header'))]
                }
                function save_panel_folding_state(header, active){
                        ls_set('pane_folding_state_'+panel_folding_get_panel_name(header), Number(active));
                }
                function load_panel_folding_state(panel_name){
                        val = ls_get('pane_folding_state_'+panel_name)
                        if (!val){ return {'exists': false, 'value': null}}
                        return {'exists': true, 'value': Boolean(Number(val))}
                }
                function set_pane_folding_start(left_header, right_header){
                        // small screen = closed
                        let right_pane_enabled = true;
                        let left_pane_enabled = true;
                        let w = window.visualViewport.width
                        if (w < 1000){
                                left_pane_enabled = false
                        }
                        if (w < 800){
                                right_pane_enabled = false
                        }

                        // get saved values if present
                        let rval = load_panel_folding_state('right')
                        if (rval['exists']){
                                right_pane_enabled = rval['value']
                        }
                        let lval = load_panel_folding_state('left')
                        if (lval['exists']){
                                left_pane_enabled = lval['value']
                        }

                        // default = enabled, so we only need to disable
                        if (!left_pane_enabled){
                                disable_side_bar(document.getElementById('left_pane'), document.getElementById('left_pane_fold_header'))
                        }
                        if (!right_pane_enabled){
                                disable_side_bar(document.getElementById('right_pane'), document.getElementById('right_pane_fold_header'))
                        }
                }

                function init_pane_folding(header){
                        set_correct_header_symbol(header);
                        header.addEventListener('click', handle_toggle_side_bar);
                }
                
                
                set_pane_folding_start()
                init_pane_folding(document.getElementById('left_pane_fold_header'));
                init_pane_folding(document.getElementById('right_pane_fold_header'));

                document.getElementById('left_pane_toggle_nav').addEventListener('click', handle_toggle_side_bar_button);
                document.getElementById('right_pane_toggle_nav').addEventListener('click', handle_toggle_side_bar_button);
        </script>

        <script src="/gardenbot/obs.html/static/load_dirtree_footer.js" type="text/javascript"></script>

        




</body>
</html>
